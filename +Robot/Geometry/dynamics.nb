(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    235263,       6744]
NotebookOptionsPosition[    228841,       6538]
NotebookOutlinePosition[    229222,       6554]
CellTagsIndexPosition[    229179,       6551]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Seg\[EAcute]df\[UDoubleDot]ggv\[EAcute]nyek", "Section",
 CellChangeTimes->{{3.6741388872274313`*^9, 3.6741388909226427`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", "ToMatlab`"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MF", "[", "a_", "]"}], ":=", 
  RowBox[{"MatrixForm", "[", "a", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NullVec", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XVec", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"YVec", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", "0", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ZVec", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "1", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IdMx", "=", 
   RowBox[{"IdentityMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RndVec", "[", "]"}], ":=", 
   RowBox[{"Transpose", "@", 
    RowBox[{"{", 
     RowBox[{"Normalize", "@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RndRot", "[", "]"}], ":=", 
   RowBox[{"R", "[", 
    RowBox[{
     RowBox[{"RndVec", "[", "]"}], ",", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cross", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{"Transpose", "@", 
   RowBox[{"{", 
    RowBox[{"Cross", "[", 
     RowBox[{
      RowBox[{"Flatten", "@", "a"}], ",", 
      RowBox[{"Flatten", "@", "b"}]}], "]"}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"equal", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"aa", "=", 
       RowBox[{"Flatten", "@", "a"}]}], ",", 
      RowBox[{"bb", "=", 
       RowBox[{"Flatten", "@", "b"}]}], ",", 
      RowBox[{"dim1", "=", 
       RowBox[{
        RowBox[{"Dimensions", "[", "a", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"aa", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
         RowBox[{"bb", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "dim1"}], "}"}]}], "]"}], ",", "1"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Bound", "[", 
    RowBox[{"x_", ",", "min_", ",", "max_"}], "]"}], ":=", 
   RowBox[{"Max", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Min", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Re", "@", "x"}], ",", "max"}], "}"}], "]"}], ",", "min"}], 
     "}"}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Rodrigues", "-", "k\[EAcute]plet"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"R", "[", 
     RowBox[{"t_", ",", "\[Phi]_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tx", "=", 
         RowBox[{"t", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"ty", "=", 
         RowBox[{"t", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"tz", "=", 
         RowBox[{"t", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"C\[Phi]", "=", 
         RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
        RowBox[{"S\[Phi]", "=", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"C\[Phi]", "*", 
        RowBox[{"IdentityMatrix", "[", "3", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "C\[Phi]"}], ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{"tx", "^", "2"}], 
            RowBox[{"tx", "*", "ty"}], 
            RowBox[{"tx", "*", "tz"}]},
           {
            RowBox[{"tx", "*", "ty"}], 
            RowBox[{"ty", "^", "2"}], 
            RowBox[{"ty", "*", "tz"}]},
           {
            RowBox[{"tx", "*", "tz"}], 
            RowBox[{"ty", "*", "tz"}], 
            RowBox[{"tz", "^", "2"}]}
          }], "\[NoBreak]", ")"}]}], "+", 
       RowBox[{"S\[Phi]", " ", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0", 
            RowBox[{"-", "tz"}], "ty"},
           {"tz", "0", 
            RowBox[{"-", "tx"}]},
           {
            RowBox[{"-", "ty"}], "tx", "0"}
          }], "\[NoBreak]", ")"}]}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Vektorb\[OAcute]l", " ", "homog\[EAcute]n", " ", "vektor"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V2HV", "[", "vec_", "]"}], ":=", 
  RowBox[{"Transpose", "@", 
   RowBox[{"{", 
    RowBox[{"Flatten", "@", 
     RowBox[{"{", 
      RowBox[{"vec", ",", "1"}], "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HV2V", "[", "hvec_", "]"}], ":=", 
   RowBox[{"hvec", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Homog\[EAcute]n", " ", "transzform\[AAcute]ci\[OAcute]s", " ", 
    "m\[AAcute]trix"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HM", "[", 
     RowBox[{"rot_", ",", "trans_"}], "]"}], ":=", 
    RowBox[{"Normal", "[", 
     RowBox[{"SparseArray", "[", 
      RowBox[{
       RowBox[{"Flatten", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", "j"}], "}"}], "\[Rule]", 
             RowBox[{"rot", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"k", ",", "4"}], "}"}], "\[Rule]", 
             RowBox[{"trans", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "1"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"4", ",", "4"}], "}"}], "\[Rule]", "1"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "4"}], "}"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Rot\[AAcute]ci\[OAcute]s", " ", "m\[AAcute]trix", " ", "HM"}], 
    "-", "b\[ODoubleAcute]l"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HM2RM", "[", "mx4x4_", "]"}], ":=", 
    RowBox[{"mx4x4", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"1", ";;", "3"}], ",", 
       RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Poz\[IAcute]ci\[OAcute]", " ", "HM"}], "-", 
    "b\[ODoubleAcute]l"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HM2P", "[", "mx4x4_", "]"}], ":=", 
    RowBox[{"Transpose", "@", 
     RowBox[{"{", 
      RowBox[{"Flatten", "@", 
       RowBox[{"mx4x4", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}]}], "}"}]}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Denavit", "-", 
    RowBox[{
    "Hartenberg", " ", "param\[EAcute]terekb\[ODoubleAcute]l", " ", 
     "homog\[EAcute]n", " ", "transzform\[AAcute]ci\[OAcute]s", " ", 
     "m\[AAcute]trix"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DH2HM", "[", 
     RowBox[{"a_", ",", "\[Alpha]_", ",", "d_", ",", "\[Gamma]_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"HM", "[", 
      RowBox[{"IdMx", ",", 
       RowBox[{"XVec", "*", "a"}]}], "]"}], ".", 
     RowBox[{"HM", "[", 
      RowBox[{
       RowBox[{"R", "[", 
        RowBox[{"XVec", ",", "\[Alpha]"}], "]"}], ",", "NullVec"}], "]"}], 
     ".", 
     RowBox[{"HM", "[", 
      RowBox[{"IdMx", ",", 
       RowBox[{"ZVec", "*", "d"}]}], "]"}], ".", 
     RowBox[{"HM", "[", 
      RowBox[{
       RowBox[{"R", "[", 
        RowBox[{"ZVec", ",", "\[Gamma]"}], "]"}], ",", "NullVec"}], "]"}]}]}],
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "Koordin\[AAcute]takeret", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KKeret", "[", 
     RowBox[{"ny\[IAcute]lhosszak_", ",", "sz\[IAcute]n_"}], "]"}], ":=", 
    RowBox[{"Flatten", "@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Arrowheads", "[", "0.05", "]"}], ",", "sz\[IAcute]n", ",", 
         RowBox[{"Arrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "i"}], "}"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ny\[IAcute]lhosszak", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "0", ",", "0"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"ny\[IAcute]lhosszak", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"ny\[IAcute]lhosszak", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "}"}]}], "}"}]}], 
      "]"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "Rajzol\[AAcute]s", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rajzol", "[", 
     RowBox[{"mit_", ",", "hova_"}], "]"}], ":=", 
    RowBox[{"Show", "@", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"KKeret", "[", "Blue", "]"}], ",", 
         RowBox[{"GeometricTransformation", "[", 
          RowBox[{
           RowBox[{"Flatten", "@", "mit"}], ",", 
           RowBox[{"AffineTransform", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"hova", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"1", ";;", "3"}], ",", 
                 RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "hova", "]"}], "<", "4"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                RowBox[{"hova", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}]}], 
               "]"}]}], "}"}], "]"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"300", ",", "300"}], "}"}]}], ",", 
       RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"eltol", "[", 
     RowBox[{"mit_", ",", "hova_"}], "]"}], ":=", 
    RowBox[{"GeometricTransformation", "[", 
     RowBox[{
      RowBox[{"Flatten", "@", "mit"}], ",", 
      RowBox[{"AffineTransform", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"hova", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", "3"}], ",", 
            RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "hova", "]"}], "<", "4"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"hova", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}]}], "]"}]}], 
        "}"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ny\[UAcute]jt", "[", 
     RowBox[{"mit_", ",", "ir\[AAcute]nyok_"}], "]"}], ":=", 
    RowBox[{"GeometricTransformation", "[", 
     RowBox[{
      RowBox[{"Flatten", "@", "mit"}], ",", 
      RowBox[{"ScalingTransform", "[", 
       RowBox[{"Flatten", "@", "ir\[AAcute]nyok"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "Inercia", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"s\[UAcute]lypont", "[", 
     RowBox[{"rimx_", ",", "mi_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"rimx", ".", "mi"}], "/", 
     RowBox[{"Total", "[", 
      RowBox[{"Flatten", "@", "mi"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"steiner", "[", "vec_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"v1", "=", 
         RowBox[{"vec", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"v2", "=", 
         RowBox[{"vec", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"v3", "=", 
         RowBox[{"vec", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{
           RowBox[{"v2", "^", "2"}], "+", 
           RowBox[{"v3", "^", "2"}]}], 
          RowBox[{
           RowBox[{"-", "v1"}], "*", "v2"}], 
          RowBox[{
           RowBox[{"-", "v1"}], "*", "v3"}]},
         {
          RowBox[{
           RowBox[{"-", "v2"}], "*", "v1"}], 
          RowBox[{
           RowBox[{"v1", "^", "2"}], "+", 
           RowBox[{"v3", "^", "2"}]}], 
          RowBox[{
           RowBox[{"-", "v2"}], "*", "v3"}]},
         {
          RowBox[{
           RowBox[{"-", "v3"}], "*", "v1"}], 
          RowBox[{
           RowBox[{"-", "v3"}], "*", "v2"}], 
          RowBox[{
           RowBox[{"v1", "^", "2"}], "+", 
           RowBox[{"v2", "^", "2"}]}]}
        }], "\[NoBreak]", ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetJacobiMX", "[", 
   RowBox[{"tr_", ",", "vec_", ",", "par_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"output", ",", 
      RowBox[{"dim", "=", 
       RowBox[{"Length", "[", "par", "]"}]}], ",", 
      RowBox[{"pos", "=", 
       RowBox[{"tr", ".", "vec"}]}], ",", 
      RowBox[{"R", "=", 
       RowBox[{"HM2RM", "[", "tr", "]"}]}], ",", "omx"}], "}"}], ",", 
    RowBox[{
     RowBox[{"output", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "6"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "dim"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"output", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "3"}], ",", 
         RowBox[{"1", ";;", "dim"}]}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Transpose", "@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Flatten", "@", 
            RowBox[{"Chop", "@", 
             RowBox[{"Simplify", "@", 
              RowBox[{"D", "[", 
               RowBox[{"pos", ",", 
                RowBox[{"par", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}]}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "dim"}], "}"}]}], "]"}]}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "3"}], ",", 
         RowBox[{"1", ";;", "dim"}]}], "]"}], "]"}]}], ";", 
     RowBox[{"omx", "=", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"R", ",", 
          RowBox[{"{", "t", "}"}]}], "]"}], ".", 
        RowBox[{"Transpose", "@", "R"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"output", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"4", ";;", "6"}], ",", 
         RowBox[{"1", ";;", "dim"}]}], "]"}], "]"}], "=", 
      RowBox[{"Normal", "[", 
       RowBox[{
        RowBox[{"CoefficientArrays", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"omx", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "2"}], "]"}], "]"}], "\[Equal]", "0"}], ",", 
            RowBox[{
             RowBox[{"omx", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "3"}], "]"}], "]"}], "\[Equal]", "0"}], ",", 
            RowBox[{
             RowBox[{"omx", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}], "\[Equal]", "0"}]}], 
           "}"}], ",", 
          RowBox[{
           SubscriptBox["\[PartialD]", "t"], 
           RowBox[{"(", 
            RowBox[{"Flatten", "[", "par", "]"}], ")"}]}]}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", "output"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.6741435785327587`*^9, 3.6741436036441946`*^9}, 
   3.674144203086481*^9, {3.6741442976628904`*^9, 3.6741442977608957`*^9}, {
   3.674207130596242*^9, 3.674207163502124*^9}, {3.6742143943117027`*^9, 
   3.674214446520689*^9}, {3.6742157740676203`*^9, 3.674215778720886*^9}, {
   3.6742160632671614`*^9, 3.6742160684294567`*^9}, {3.674249237477013*^9, 
   3.674249251900838*^9}, {3.6742493179516163`*^9, 3.674249363497221*^9}, 
   3.6742496704507775`*^9, {3.6745776281556807`*^9, 3.674577647683797*^9}, 
   3.6745777453533835`*^9, {3.675617992323168*^9, 3.675618059244995*^9}, {
   3.6756190019389143`*^9, 3.675619017643812*^9}, {3.675619721347062*^9, 
   3.6756197239022083`*^9}, {3.680366931467743*^9, 3.6803669430884075`*^9}, {
   3.6811483864883566`*^9, 3.681148401793232*^9}, {3.696591429345304*^9, 
   3.696591435510657*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MF", "@", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"DH2HM", "[", 
      RowBox[{"0", ",", "0", ",", "L1", ",", "Q1"}], "]"}], ".", 
     RowBox[{"DH2HM", "[", 
      RowBox[{"L2", ",", 
       RowBox[{
        RowBox[{"-", "Pi"}], "/", "2"}], ",", "0", ",", 
       RowBox[{"Q2", "-", 
        RowBox[{"Pi", "/", "2"}]}]}], "]"}]}], ")"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.698993840427904*^9, 3.698993926234812*^9}, {
   3.698994115873659*^9, 3.6989941245991573`*^9}, {3.698994200914523*^9, 
   3.6989942015155573`*^9}, {3.69899425034435*^9, 3.6989942958459525`*^9}, 
   3.698994332847069*^9, {3.698994366335984*^9, 3.698994366879015*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"Cos", "[", "Q1", "]"}], " ", 
       RowBox[{"Sin", "[", "Q2", "]"}]}], 
      RowBox[{
       RowBox[{"Cos", "[", "Q1", "]"}], " ", 
       RowBox[{"Cos", "[", "Q2", "]"}]}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "Q1", "]"}]}], 
      RowBox[{"L2", " ", 
       RowBox[{"Cos", "[", "Q1", "]"}]}]},
     {
      RowBox[{
       RowBox[{"Sin", "[", "Q1", "]"}], " ", 
       RowBox[{"Sin", "[", "Q2", "]"}]}], 
      RowBox[{
       RowBox[{"Cos", "[", "Q2", "]"}], " ", 
       RowBox[{"Sin", "[", "Q1", "]"}]}], 
      RowBox[{"Cos", "[", "Q1", "]"}], 
      RowBox[{"L2", " ", 
       RowBox[{"Sin", "[", "Q1", "]"}]}]},
     {
      RowBox[{"Cos", "[", "Q2", "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "Q2", "]"}]}], "0", "L1"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6989939274498816`*^9, {3.6989941219340053`*^9, 3.6989941248631725`*^9}, 
   3.698994201956582*^9, {3.69899426992747*^9, 3.698994296104967*^9}, 
   3.698994333239091*^9, 3.6989943675710545`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Param\[EAcute]terek", "Section",
 CellChangeTimes->{
  3.6741388655491915`*^9, {3.6741389057524905`*^9, 3.674138909040679*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"g", "=", "9.81"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DH", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0", "0", 
       RowBox[{"342.87", "/", "1000"}], "0"},
      {
       RowBox[{"250", "/", "1000"}], "0", 
       RowBox[{"105", "/", "1000"}], "0"},
      {
       RowBox[{"356.83", "/", "1000"}], "0", 
       RowBox[{
        RowBox[{"-", "30.50"}], "/", "1000"}], 
       RowBox[{
        RowBox[{"-", "35"}], "\[Degree]"}]},
      {
       RowBox[{"200", "/", "1000"}], "0", "0", "0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["T", "B1"], "[", "qB1_", "]"}], ":=", 
   RowBox[{"DH2HM", "[", 
    RowBox[{
     RowBox[{"DH", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"DH", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{"DH", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
     RowBox[{"qB1", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["T", "12"], "[", "q12_", "]"}], ":=", 
   RowBox[{"DH2HM", "[", 
    RowBox[{
     RowBox[{"DH", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"DH", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{"DH", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "3"}], "]"}], "]"}], ",", 
     RowBox[{"q12", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["T", "B2"], "[", "qB2_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     SubscriptBox["T", "B1"], "[", "qB2", "]"}], ".", 
    RowBox[{
     SubscriptBox["T", "12"], "[", "qB2", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["T", "23"], "[", "q23_", "]"}], ":=", 
   RowBox[{"DH2HM", "[", 
    RowBox[{
     RowBox[{"DH", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"DH", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"DH", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "3"}], "]"}], "]"}], "+", 
      RowBox[{"q23", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ",", 
     RowBox[{"DH", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "4"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["T", "B3"], "[", "qB3_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     SubscriptBox["T", "B2"], "[", "qB3", "]"}], ".", 
    RowBox[{
     SubscriptBox["T", "23"], "[", "qB3", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["T", 
     RowBox[{"3", "TCP"}]], "[", "]"}], ":=", 
   RowBox[{"DH2HM", "[", 
    RowBox[{
     RowBox[{"DH", "[", 
      RowBox[{"[", 
       RowBox[{"4", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"DH", "[", 
      RowBox[{"[", 
       RowBox[{"4", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{"DH", "[", 
      RowBox[{"[", 
       RowBox[{"4", ",", "3"}], "]"}], "]"}], ",", 
     RowBox[{"DH", "[", 
      RowBox[{"[", 
       RowBox[{"4", ",", "4"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["T", "BTCP"], "[", "qBTCP_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     SubscriptBox["T", "B3"], "[", "qBTCP", "]"}], ".", 
    RowBox[{
     SubscriptBox["T", 
      RowBox[{"3", "TCP"}]], "[", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.674156794140926*^9, 3.6741567954830027`*^9}, {
   3.6741568523872576`*^9, 3.6741570609091845`*^9}, {3.674157106346783*^9, 
   3.6741571263969297`*^9}, {3.674157209494683*^9, 3.674157241697525*^9}, {
   3.67415730839834*^9, 3.6741574257190504`*^9}, {3.674157460768055*^9, 
   3.674157465616332*^9}, {3.674157647943761*^9, 3.674157648879814*^9}, {
   3.674204716279151*^9, 3.6742049587790213`*^9}, {3.6742058355081673`*^9, 
   3.674205835802184*^9}, {3.674212679183603*^9, 3.674212694235464*^9}, {
   3.6742129403125386`*^9, 3.6742130105045533`*^9}, {3.674214579715307*^9, 
   3.6742145804833508`*^9}, {3.6742786371812077`*^9, 
   3.6742786456016893`*^9}, {3.674278818446576*^9, 3.674278822292796*^9}, 
   3.674278865461265*^9, {3.6742795896676874`*^9, 3.6742796025204225`*^9}, {
   3.6742898519210997`*^9, 3.6742898532621765`*^9}, {3.6742957873165846`*^9, 
   3.6742957882036357`*^9}, {3.674297374055341*^9, 3.6742973777845545`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["r", "1"], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "102.22", "}"}], ",", 
      RowBox[{"{", "0.00", "}"}], ",", 
      RowBox[{"{", "56.23", "}"}]}], "}"}], "/", "1000"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["m", "1"], "=", 
   RowBox[{"6361.85", "/", "1000"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[CapitalTheta]", "1"], "=", 
   RowBox[{
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"18734954.15", 
        RowBox[{"-", "0.30"}], "3311755.88"},
       {
        RowBox[{"-", "0.30"}], "88033393.33", 
        RowBox[{"-", "0.20"}]},
       {"3311755.88", 
        RowBox[{"-", "0.20"}], "94695299.13"}
      }], "\[NoBreak]", ")"}], "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "9"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["J", "1"], "=", 
   RowBox[{"GetJacobiMX", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["T", "B1"], "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["q", "1"], "[", "t", "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["q", "2"], "[", "t", "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["q", "3"], "[", "t", "]"}], "}"}]}], "}"}], "]"}], ",", 
     RowBox[{"V2HV", "[", 
      SubscriptBox["r", "1"], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["q", "1"], "[", "t", "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["q", "2"], "[", "t", "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["q", "3"], "[", "t", "]"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["Jv", "1"], "=", 
   RowBox[{
    SubscriptBox["J", "1"], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "3"}], ",", ";;"}], "]"}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["Jv", "1"], "//", "MF"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["J\[Omega]", "1"], "=", 
   RowBox[{
    SubscriptBox["J", "1"], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"4", ";;", "6"}], ",", ";;"}], "]"}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["J\[Omega]", "1"], "//", "MF"}]}]}], "Input",
 CellChangeTimes->{
  3.6742072249456387`*^9, {3.6742073087544317`*^9, 3.6742073230012465`*^9}, {
   3.6742073530159636`*^9, 3.674207500247385*^9}, {3.6742075521143513`*^9, 
   3.6742076030802665`*^9}, 3.674207665893859*^9, {3.6742080277215548`*^9, 
   3.6742080475806904`*^9}, {3.674211752996628*^9, 3.6742117531656375`*^9}, {
   3.6742118258597956`*^9, 3.674211826264819*^9}, {3.674211908259508*^9, 
   3.674211913736822*^9}, {3.67421195636226*^9, 3.6742119792195673`*^9}, {
   3.674214121799116*^9, 3.674214131905694*^9}, {3.674215418539285*^9, 
   3.6742154362032957`*^9}, {3.6742156102712517`*^9, 
   3.6742157018284883`*^9}, {3.6742158026272535`*^9, 3.67421580501239*^9}, 
   3.6742160335294604`*^9, {3.6742161514702063`*^9, 3.674216153029296*^9}, {
   3.674216223091303*^9, 3.674216356078909*^9}, {3.6742163931170273`*^9, 
   3.6742163944541044`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "0.10222`"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         SubscriptBox["q", "1"], "[", "t", "]"}], "]"}]}], "0", "0"},
     {
      RowBox[{"0.10222`", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["q", "1"], "[", "t", "]"}], "]"}]}], "0", "0"},
     {"0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.696838228372548*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0"},
     {"0", "0", "0"},
     {"1.`", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6968382284295516`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["r", "2"], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "132.01948", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"-", "0.01867"}], "}"}], ",", 
      RowBox[{"{", "100.75871", "}"}]}], "}"}], "/", "1000"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["m", "2"], "=", 
   RowBox[{"6037.60068", "/", "1000"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[CapitalTheta]", "2"], "=", 
   RowBox[{
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"39542821.19944", 
        RowBox[{"-", "33070.57576"}], 
        RowBox[{"-", "5026653.95273"}]},
       {
        RowBox[{"-", "33070.57576"}], "140762076.21739", 
        RowBox[{"-", "33636.49565"}]},
       {
        RowBox[{"-", "5026653.95273"}], 
        RowBox[{"-", "33636.49565"}], "124128482.726953"}
      }], "\[NoBreak]", ")"}], "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "9"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["J", "2"], "=", 
   RowBox[{"GetJacobiMX", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["T", "B2"], "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["q", "1"], "[", "t", "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["q", "2"], "[", "t", "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["q", "3"], "[", "t", "]"}], "}"}]}], "}"}], "]"}], ",", 
     RowBox[{"V2HV", "[", 
      SubscriptBox["r", "2"], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["q", "1"], "[", "t", "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["q", "2"], "[", "t", "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["q", "3"], "[", "t", "]"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["Jv", "2"], "=", 
   RowBox[{
    SubscriptBox["J", "2"], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "3"}], ",", ";;"}], "]"}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["Jv", "2"], "//", "MF"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["J\[Omega]", "2"], "=", 
   RowBox[{
    SubscriptBox["J", "2"], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"4", ";;", "6"}], ",", ";;"}], "]"}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["J\[Omega]", "2"], "//", "MF"}]}]}], "Input",
 CellChangeTimes->{{3.674216400569454*^9, 3.674216408906931*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"0.00001867`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
       RowBox[{"0.25`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"0.13201948`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{
       RowBox[{"0.00001867`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
       RowBox[{"0.13201948`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], "0"},
     {
      RowBox[{
       RowBox[{"0.25`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"0.13201948`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"0.00001867`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{
       RowBox[{"0.13201948`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"0.00001867`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], "0"},
     {"0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6968382289095793`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0"},
     {"0", "0", "0"},
     {"1.`", "1.`", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6968382290065846`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["r", "3"], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"-", "19.20"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"-", "6.50"}], "}"}], ",", 
      RowBox[{"{", "362.73", "}"}]}], "}"}], "/", "1000"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["m", "3"], "=", 
   RowBox[{"1263.86", "/", "1000"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[CapitalTheta]", "3"], "=", 
   RowBox[{
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"83263277.68", "265484.87", 
        RowBox[{"-", "220190.74"}]},
       {"265484.87", "83957204.15", 
        RowBox[{"-", "69497.83"}]},
       {
        RowBox[{"-", "220190.74"}], 
        RowBox[{"-", "69497.83"}], "1988847.21"}
      }], "\[NoBreak]", ")"}], "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "9"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["J", "3"], "=", 
   RowBox[{"GetJacobiMX", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["T", "B3"], "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["q", "1"], "[", "t", "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["q", "2"], "[", "t", "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["q", "3"], "[", "t", "]"}], "}"}]}], "}"}], "]"}], ",", 
     RowBox[{"V2HV", "[", 
      SubscriptBox["r", "3"], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["q", "1"], "[", "t", "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["q", "2"], "[", "t", "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["q", "3"], "[", "t", "]"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["Jv", "3"], "=", 
   RowBox[{
    SubscriptBox["J", "3"], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "3"}], ",", ";;"}], "]"}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["Jv", "3"], "//", "MF"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["J\[Omega]", "3"], "=", 
   RowBox[{
    SubscriptBox["J", "3"], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"4", ";;", "6"}], ",", ";;"}], "]"}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["J\[Omega]", "3"], "//", "MF"}]}]}], "Input",
 CellChangeTimes->{{3.674216405311725*^9, 3.6742164063827868`*^9}, 
   3.674296708803291*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.005688179290061637`"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
       RowBox[{"0.25`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"0.33737403391336956`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.005688179290061634`"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
       RowBox[{"0.3373740339133695`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], "0"},
     {
      RowBox[{
       RowBox[{"0.25`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"0.33737403391336956`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
       RowBox[{"0.005688179290061637`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{
       RowBox[{"0.3373740339133695`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
       RowBox[{"0.005688179290061634`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], "0"},
     {"0", "0", "1.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6968382293376036`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0"},
     {"0", "0", "0"},
     {"0.9999999999999999`", "0.9999999999999999`", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.696838229495612*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["J", "TCP"], "=", 
   RowBox[{"GetJacobiMX", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["T", "BTCP"], "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["q", "1"], "[", "t", "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["q", "2"], "[", "t", "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["q", "3"], "[", "t", "]"}], "}"}]}], "}"}], "]"}], ",", 
     RowBox[{"V2HV", "[", "NullVec", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["q", "1"], "[", "t", "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["q", "2"], "[", "t", "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["q", "3"], "[", "t", "]"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["Jv", "TCP"], "=", 
   RowBox[{
    SubscriptBox["J", "TCP"], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "3"}], ",", ";;"}], "]"}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["Jv", "TCP"], "//", "MF"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["J\[Omega]", "TCP"], "=", 
   RowBox[{
    SubscriptBox["J", "TCP"], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"4", ";;", "6"}], ",", ";;"}], "]"}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["J\[Omega]", "TCP"], "//", "MF"}]}]}], "Input",
 CellChangeTimes->{{3.674647001122343*^9, 3.6746470820759735`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"0.11471528727020923`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
       RowBox[{"0.25`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"0.5206604088577984`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{
       RowBox[{"0.11471528727020923`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
       RowBox[{"0.5206604088577984`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], "0"},
     {
      RowBox[{
       RowBox[{"0.25`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"0.5206604088577984`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"0.11471528727020923`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{
       RowBox[{"0.5206604088577984`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"0.11471528727020923`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], "0"},
     {"0", "0", "1.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6968382299336376`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0"},
     {"0", "0", "0"},
     {"0.9999999999999999`", "0.9999999999999999`", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6968382300786457`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Geometria", "Section",
 CellChangeTimes->{{3.674156785277419*^9, 3.6741567865784936`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["LINK", "0"], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"EdgeForm", "[", "]"}], ",", 
     RowBox[{"ny\[UAcute]jt", "[", 
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            RowBox[{"StringJoin", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ToString", "[", "0", "]"}], ",", "\"\<.stl\>\""}], 
              "}"}], "]"}]}], "}"}], "]"}], ",", "\"\<GraphicsComplex\>\""}], 
        "]"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}], "/", "1000"}]}], "]"}], 
     ",", 
     RowBox[{"KKeret", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"300", ",", "300", ",", "100"}], "}"}], "/", "1000"}], ",", 
       "Black"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["LINK", "1"], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"EdgeForm", "[", "]"}], ",", 
     RowBox[{"ny\[UAcute]jt", "[", 
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            RowBox[{"StringJoin", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ToString", "[", "1", "]"}], ",", "\"\<.stl\>\""}], 
              "}"}], "]"}]}], "}"}], "]"}], ",", "\"\<GraphicsComplex\>\""}], 
        "]"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}], "/", "1000"}]}], "]"}], 
     ",", 
     RowBox[{"KKeret", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"500", ",", "200", ",", "300"}], "}"}], "/", "1000"}], ",", 
       "Red"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["LINK", "2"], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"EdgeForm", "[", "]"}], ",", 
     RowBox[{"ny\[UAcute]jt", "[", 
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            RowBox[{"StringJoin", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ToString", "[", "2", "]"}], ",", "\"\<.stl\>\""}], 
              "}"}], "]"}]}], "}"}], "]"}], ",", "\"\<GraphicsComplex\>\""}], 
        "]"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}], "/", "1000"}]}], "]"}], 
     ",", 
     RowBox[{"KKeret", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"500", ",", "200", ",", "300"}], "}"}], "/", "1000"}], ",", 
       "Green"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["LINK", "3"], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"EdgeForm", "[", "]"}], ",", 
     RowBox[{"ny\[UAcute]jt", "[", 
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            RowBox[{"StringJoin", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ToString", "[", "3", "]"}], ",", "\"\<.stl\>\""}], 
              "}"}], "]"}]}], "}"}], "]"}], ",", "\"\<GraphicsComplex\>\""}], 
        "]"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}], "/", "1000"}]}], "]"}], 
     ",", 
     RowBox[{"KKeret", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"200", ",", "200", ",", "900"}], "}"}], "/", "1000"}], ",", 
       "Blue"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ROBOT", "[", "q_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["LINK", "0"], ",", 
     RowBox[{"eltol", "[", 
      RowBox[{
       SubscriptBox["LINK", "1"], ",", 
       RowBox[{
        SubscriptBox["T", "B1"], "[", "q", "]"}]}], "]"}], ",", 
     RowBox[{"eltol", "[", 
      RowBox[{
       SubscriptBox["LINK", "2"], ",", 
       RowBox[{
        SubscriptBox["T", "B2"], "[", "q", "]"}]}], "]"}], ",", 
     RowBox[{"eltol", "[", 
      RowBox[{
       SubscriptBox["LINK", "3"], ",", 
       RowBox[{
        SubscriptBox["T", "B3"], "[", "q", "]"}]}], "]"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6741389123538685`*^9, 3.6741389133339243`*^9}, {
   3.674139024892305*^9, 3.6741390265934024`*^9}, {3.674139096035374*^9, 
   3.674139148899398*^9}, {3.6741392065706964`*^9, 3.674139209877886*^9}, 
   3.6741395033576717`*^9, {3.6741396104267955`*^9, 3.6741396199823427`*^9}, {
   3.6741398051629343`*^9, 3.6741398055499563`*^9}, {3.674139903459556*^9, 
   3.6741399254208126`*^9}, {3.6741403782207108`*^9, 
   3.6741404429074106`*^9}, {3.674140524506078*^9, 3.6741405281162844`*^9}, {
   3.6741420155993633`*^9, 3.674142015972385*^9}, {3.674143286910078*^9, 
   3.674143302557974*^9}, {3.674143468680475*^9, 3.6741434722326784`*^9}, {
   3.6741442243016944`*^9, 3.6741442856062007`*^9}, {3.674150947312228*^9, 
   3.674151012338948*^9}, {3.6741512597640996`*^9, 3.6741513343833675`*^9}, {
   3.67415748218328*^9, 3.6741575981089106`*^9}, {3.6741576625605965`*^9, 
   3.6741576630876265`*^9}, {3.674157764255413*^9, 3.674157764773443*^9}, {
   3.6742050677692547`*^9, 3.6742051637807465`*^9}, 3.6742058817648125`*^9, {
   3.674212710634402*^9, 3.674212744078315*^9}, {3.674213022772255*^9, 
   3.674213037784114*^9}, {3.6742144821627274`*^9, 3.6742145700577545`*^9}, {
   3.6742146006965075`*^9, 3.6742146093650026`*^9}, 3.6742147326680555`*^9, {
   3.674278752567808*^9, 3.674278753642869*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"WORKSPACE", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ParametricPlot3D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["T", "BTCP"], "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            SubscriptBox["q", "1"], "}"}], ",", 
           RowBox[{"{", 
            SubscriptBox["q", "2"], "}"}], ",", 
           RowBox[{"{", "0", "}"}]}], "}"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["q", "1"], ",", 
         RowBox[{
          RowBox[{"-", "180"}], "\[Degree]"}], ",", 
         RowBox[{"180", "\[Degree]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["q", "2"], ",", 
         RowBox[{
          RowBox[{"-", "180"}], "\[Degree]"}], ",", 
         RowBox[{"180", "\[Degree]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ExclusionsStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"None", ",", "Red"}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Green", ",", 
          RowBox[{"Opacity", "[", "0.1", "]"}], ",", 
          RowBox[{"Specularity", "[", 
           RowBox[{"White", ",", "20"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"Mesh", "\[Rule]", "None"}]}], "]"}], ",", 
     RowBox[{"ParametricPlot3D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["T", "BTCP"], "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            SubscriptBox["q", "1"], "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", 
            SubscriptBox["q", "3"], "}"}]}], "}"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["q", "1"], ",", 
         RowBox[{
          RowBox[{"-", "180"}], "\[Degree]"}], ",", 
         RowBox[{"180", "\[Degree]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["q", "3"], ",", 
         RowBox[{
          RowBox[{"-", "486"}], "/", "1000"}], ",", "0"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ExclusionsStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"None", ",", "Red"}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Green", ",", 
          RowBox[{"Opacity", "[", "0.1", "]"}], ",", 
          RowBox[{"Specularity", "[", 
           RowBox[{"White", ",", "20"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"Mesh", "\[Rule]", "None"}]}], "]"}], ",", 
     RowBox[{"ParametricPlot3D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["T", "BTCP"], "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            SubscriptBox["q", "1"], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"180", "\[Degree]"}], "}"}], ",", 
           RowBox[{"{", 
            SubscriptBox["q", "3"], "}"}]}], "}"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["q", "1"], ",", 
         RowBox[{
          RowBox[{"-", "180"}], "\[Degree]"}], ",", 
         RowBox[{"180", "\[Degree]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["q", "3"], ",", 
         RowBox[{
          RowBox[{"-", "486"}], "/", "1000"}], ",", "0"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ExclusionsStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"None", ",", "Red"}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Green", ",", 
          RowBox[{"Opacity", "[", "0.1", "]"}], ",", 
          RowBox[{"Specularity", "[", 
           RowBox[{"White", ",", "20"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"Mesh", "\[Rule]", "None"}]}], "]"}], ",", 
     RowBox[{"ParametricPlot3D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["T", "BTCP"], "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            SubscriptBox["q", "1"], "}"}], ",", 
           RowBox[{"{", 
            SubscriptBox["q", "2"], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "486"}], "/", "1000"}], "}"}]}], "}"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["q", "1"], ",", 
         RowBox[{
          RowBox[{"-", "180"}], "\[Degree]"}], ",", 
         RowBox[{"180", "\[Degree]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["q", "2"], ",", 
         RowBox[{
          RowBox[{"-", "180"}], "\[Degree]"}], ",", 
         RowBox[{"180", "\[Degree]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ExclusionsStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"None", ",", "Red"}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Green", ",", 
          RowBox[{"Opacity", "[", "0.1", "]"}], ",", 
          RowBox[{"Specularity", "[", 
           RowBox[{"White", ",", "20"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"Mesh", "\[Rule]", "None"}]}], "]"}]}], "}"}]}], 
  ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Show", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Graphics3D", "[", 
       RowBox[{"ROBOT", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "q1", "}"}], ",", 
          RowBox[{"{", "q2", "}"}], ",", 
          RowBox[{"{", "q3", "}"}]}], "}"}], "]"}], "]"}], ",", "WORKSPACE"}],
      "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"q1", ",", "0"}], "}"}], ",", 
     RowBox[{
      RowBox[{"-", "180"}], "\[Degree]"}], ",", 
     RowBox[{"180", "\[Degree]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"q2", ",", "0"}], "}"}], ",", 
     RowBox[{
      RowBox[{"-", "180"}], "\[Degree]"}], ",", 
     RowBox[{"180", "\[Degree]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"q3", ",", "0"}], "}"}], ",", 
     RowBox[{
      RowBox[{"-", "486"}], "/", "1000"}], ",", "0"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.674157671166089*^9, 3.674157739820016*^9}, {
   3.6742056148195443`*^9, 3.6742056454022937`*^9}, 3.674214614976324*^9}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`q1$$ = 0, $CellContext`q2$$ = 
    0, $CellContext`q3$$ = 0, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`q1$$], 0}, (-180) Degree, 180 Degree}, {{
       Hold[$CellContext`q2$$], 0}, (-180) Degree, 180 Degree}, {{
       Hold[$CellContext`q3$$], 0}, 
      Rational[-243, 500], 0}}, Typeset`size$$ = {468., {238., 247.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`q1$479256$$ = 0, $CellContext`q2$479257$$ = 
    0, $CellContext`q3$479258$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`q1$$ = 0, $CellContext`q2$$ = 
        0, $CellContext`q3$$ = 0}, "ControllerVariables" :> {
        Hold[$CellContext`q1$$, $CellContext`q1$479256$$, 0], 
        Hold[$CellContext`q2$$, $CellContext`q2$479257$$, 0], 
        Hold[$CellContext`q3$$, $CellContext`q3$479258$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Show[{
         Graphics3D[
          $CellContext`ROBOT[{{$CellContext`q1$$}, {$CellContext`q2$$}, \
{$CellContext`q3$$}}]], $CellContext`WORKSPACE}], 
      "Specifications" :> {{{$CellContext`q1$$, 0}, (-180) Degree, 180 
         Degree}, {{$CellContext`q2$$, 0}, (-180) Degree, 180 
         Degree}, {{$CellContext`q3$$, 0}, 
         Rational[-243, 500], 0}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{529., {335., 342.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.696838287684941*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["T", "B1"], "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        SubscriptBox["q", "1"], "}"}], ",", 
       RowBox[{"{", 
        SubscriptBox["q", "2"], "}"}], ",", 
       RowBox[{"{", 
        SubscriptBox["q", "3"], "}"}]}], "}"}], "]"}], "//", "Simplify"}], "//",
    "Chop"}], "//", "MF"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["T", "B2"], "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        SubscriptBox["q", "1"], "}"}], ",", 
       RowBox[{"{", 
        SubscriptBox["q", "2"], "}"}], ",", 
       RowBox[{"{", 
        SubscriptBox["q", "3"], "}"}]}], "}"}], "]"}], "//", "Simplify"}], "//",
    "Chop"}], "//", "MF"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["T", "B3"], "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        SubscriptBox["q", "1"], "}"}], ",", 
       RowBox[{"{", 
        SubscriptBox["q", "2"], "}"}], ",", 
       RowBox[{"{", 
        SubscriptBox["q", "3"], "}"}]}], "}"}], "]"}], "//", "Simplify"}], "//",
    "Chop"}], "//", "MF"}]}], "Input",
 CellChangeTimes->{{3.6742045201889353`*^9, 3.674204631607308*^9}, {
  3.674212825047946*^9, 3.6742128290111723`*^9}, {3.674213043465439*^9, 
  3.6742130458295736`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1.`", " ", 
       RowBox[{"Cos", "[", 
        SubscriptBox["q", "1"], "]"}]}], 
      RowBox[{
       RowBox[{"-", "1.`"}], " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["q", "1"], "]"}]}], "0", "0"},
     {
      RowBox[{"1.`", " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["q", "1"], "]"}]}], 
      RowBox[{"1.`", " ", 
       RowBox[{"Cos", "[", 
        SubscriptBox["q", "1"], "]"}]}], "0", "0"},
     {"0", "0", "1.`", "0.34287`"},
     {"0", "0", "0", "1.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.696838290592107*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"1.`", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "2"], "]"}]}], "-", 
       RowBox[{"1.`", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "2"], "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1.`"}], " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "2"], "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}]}], "-", 
       RowBox[{"1.`", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "2"], "]"}]}]}], "0", 
      RowBox[{"0.25`", " ", 
       RowBox[{"Cos", "[", 
        SubscriptBox["q", "1"], "]"}]}]},
     {
      RowBox[{
       RowBox[{"1.`", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "2"], "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}]}], "+", 
       RowBox[{"1.`", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "2"], "]"}]}]}], 
      RowBox[{
       RowBox[{"1.`", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "2"], "]"}]}], "-", 
       RowBox[{"1.`", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "2"], "]"}]}]}], "0", 
      RowBox[{"0.25`", " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["q", "1"], "]"}]}]},
     {"0", "0", "1.`", "0.44787`"},
     {"0", "0", "0", "1.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6968382906671114`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"0.8191520442889919`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}], "]"}]}], "+", 
       RowBox[{"0.573576436351046`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}], "]"}]}]}], 
      RowBox[{
       RowBox[{"0.573576436351046`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}], "]"}]}], "-", 
       RowBox[{"0.8191520442889919`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}], "]"}]}]}], "0", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.35683`", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "2"], "]"}]}]}], ")"}]}], "-", 
       RowBox[{"0.35683`", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "2"], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.573576436351046`"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}], "]"}]}], "+", 
       RowBox[{"0.8191520442889919`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}], "]"}]}]}], 
      RowBox[{
       RowBox[{"0.8191520442889919`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}], "]"}]}], "+", 
       RowBox[{"0.573576436351046`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}], "]"}]}]}], "0", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.35683`", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "2"], "]"}]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}]}], "+", 
       RowBox[{"0.35683`", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "2"], "]"}]}]}]},
     {"0", "0", "1.`", 
      RowBox[{"0.41737`", "\[VeryThinSpace]", "+", 
       RowBox[{"1.`", " ", 
        SubscriptBox["q", "3"]}]}]},
     {"0", "0", "0", "1.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.696838290892124*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Inverz", " ", "Kinematika"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["pos", "TCP"], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"HV2V", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["T", "BTCP"], "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             SubscriptBox["q", "1"], "}"}], ",", 
            RowBox[{"{", 
             SubscriptBox["q", "2"], "}"}], ",", 
            RowBox[{"{", 
             SubscriptBox["q", "3"], "}"}]}], "}"}], "]"}], ".", 
         RowBox[{"V2HV", "[", "NullVec", "]"}]}], "]"}], "//", "Simplify"}], "//",
       "Chop"}]}], ";", 
    RowBox[{"eq", "=", 
     RowBox[{"FullSimplify", "@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"equal", "[", 
        RowBox[{
         SubscriptBox["pos", "TCP"], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            SubscriptBox["x", "TCP"], "}"}], ",", 
           RowBox[{"{", 
            SubscriptBox["y", "TCP"], "}"}], ",", 
           RowBox[{"{", 
            SubscriptBox["z", "TCP"], "}"}]}], "}"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coef", "=", 
     RowBox[{"Normal", "@", 
      RowBox[{"CoefficientArrays", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"eq", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "2"}], "]"}], "]"}], ")"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             SubscriptBox["q", "1"], "]"}], "\[Rule]", "C1"}], ",", 
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["q", "1"], "]"}], "\[Rule]", "S1"}], ",", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{
              SubscriptBox["q", "1"], "+", 
              SubscriptBox["q", "2"]}], "]"}], "\[Rule]", "C12"}], ",", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{
              SubscriptBox["q", "1"], "+", 
              SubscriptBox["q", "2"]}], "]"}], "\[Rule]", "S12"}]}], "}"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"C1", ",", "S1", ",", "C12", ",", "S12"}], "}"}]}], 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TrigTrafo", "[", 
      RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"beta", ",", "C"}], "}"}], ",", 
       RowBox[{
        RowBox[{"C", "=", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"A", "^", "2"}], "+", 
           RowBox[{"B", "^", "2"}]}], "]"}]}], ";", 
        RowBox[{"beta", "=", 
         RowBox[{"ArcTan", "[", 
          RowBox[{"A", ",", 
           RowBox[{"-", "B"}]}], "]"}]}], ";", 
        RowBox[{"{", 
         RowBox[{"C", ",", "beta"}], "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"L1", "=", 
     RowBox[{"coef", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1", ",", "1"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tmp", "=", 
     RowBox[{"TrigTrafo", "[", 
      RowBox[{
       RowBox[{"coef", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1", ",", "3"}], "]"}], "]"}], ",", 
       RowBox[{"coef", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1", ",", "4"}], "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"L2", "=", 
     RowBox[{"tmp", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"beta", "=", 
     RowBox[{"tmp", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq3", "=", 
     RowBox[{
      SubscriptBox["q", "3"], "/.", 
      RowBox[{"Simplify", "@", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{"eq", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          SubscriptBox["q", "3"]}], "]"}]}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"InverseKinematics", "[", 
      RowBox[{"x_", ",", "y_", ",", "zz_", ",", "rl_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"C2", "=", 
          RowBox[{"Bound", "[", 
           RowBox[{
            FractionBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "-", 
              SuperscriptBox["L1", "2"], "-", 
              SuperscriptBox["L2", "2"]}], 
             RowBox[{"2", "L1", " ", "L2"}]], ",", 
            RowBox[{"-", "1"}], ",", "1"}], "]"}]}], ",", 
         RowBox[{"RL", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"rl", ">=", "0"}], ",", "1", ",", 
            RowBox[{"-", "1"}]}], "]"}]}], ",", "L", ",", "S1", ",", "C1", 
         ",", "q1", ",", "q2", ",", "q3"}], "}"}], ",", 
       RowBox[{
        RowBox[{"q2", "=", 
         RowBox[{"ArcTan", "[", 
          RowBox[{"C2", ",", 
           RowBox[{"RL", " ", 
            SqrtBox[
             RowBox[{"1", "-", 
              SuperscriptBox["C2", "2"]}]]}]}], "]"}]}], ";", 
        RowBox[{"L", "=", 
         RowBox[{"L1", "+", 
          RowBox[{"L2", " ", "C2"}]}]}], ";", 
        RowBox[{"S1", "=", 
         FractionBox[
          RowBox[{
           RowBox[{"y", " ", "L"}], " ", "-", 
           RowBox[{"RL", " ", "x", " ", 
            SqrtBox[
             RowBox[{"Abs", "@", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "-", 
                SuperscriptBox["L", "2"]}], ")"}]}]]}]}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]]}], ";", 
        RowBox[{"C1", "=", 
         FractionBox[
          RowBox[{
           RowBox[{"x", " ", "L"}], " ", "+", 
           RowBox[{"RL", " ", "y", " ", 
            SqrtBox[
             RowBox[{"Abs", "@", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "-", 
                SuperscriptBox["L", "2"]}], ")"}]}]]}]}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]]}], ";", 
        RowBox[{"q1", "=", 
         RowBox[{"Evaluate", "@", 
          RowBox[{"ArcTan", "[", 
           RowBox[{"C1", ",", "S1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q3", "=", 
         RowBox[{"Bound", "[", 
          RowBox[{
           RowBox[{"eq3", "/.", 
            RowBox[{
             SubscriptBox["z", "TCP"], "\[Rule]", "zz"}]}], ",", 
           RowBox[{
            RowBox[{"-", "486"}], "/", "1000"}], ",", "0"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "q1", "}"}], ",", 
          RowBox[{"{", "q2", "}"}], ",", 
          RowBox[{"{", "q3", "}"}]}], "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6742170975073166`*^9, 3.6742171341054096`*^9}, {
  3.6742171729116297`*^9, 3.6742172155180664`*^9}, {3.6742172535472417`*^9, 
  3.674217372292033*^9}, {3.6742175581426635`*^9, 3.674217593002657*^9}, {
  3.674217771664876*^9, 3.6742177724589214`*^9}, {3.674217912602937*^9, 
  3.674217952851239*^9}, {3.674235602979164*^9, 3.6742356733301883`*^9}, {
  3.674235715215584*^9, 3.6742357158156185`*^9}, {3.6742357514726577`*^9, 
  3.6742357681396112`*^9}, {3.6742358017645345`*^9, 3.674235814402257*^9}, {
  3.6742358731376166`*^9, 3.674235883745223*^9}, {3.6742499750281987`*^9, 
  3.6742500035078278`*^9}, {3.6742500658123913`*^9, 3.674250106411713*^9}, {
  3.6742900874025683`*^9, 3.67429010806275*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MF", "@", 
  SubscriptBox["pos", "TCP"]}]], "Input",
 CellChangeTimes->{{3.6967604682927737`*^9, 3.6967604690928197`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"0.25`", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}]}], "+", 
       RowBox[{"0.5206604088577984`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}], "]"}]}], "+", 
       RowBox[{"0.11471528727020923`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.11471528727020923`"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}], "]"}]}], "+", 
       RowBox[{"0.25`", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["q", "1"], "]"}]}], "+", 
       RowBox[{"0.5206604088577984`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}], "]"}]}]}]},
     {
      RowBox[{"0.41737`", "\[VeryThinSpace]", "+", 
       RowBox[{"1.`", " ", 
        SubscriptBox["q", "3"]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.696838291585164*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"konf", "=", 
     RowBox[{"InverseKinematics", "[", 
      RowBox[{"x", ",", "y", ",", "z", ",", "lr"}], "]"}]}], ";", 
    RowBox[{"Column", "@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"konf", "//", "MF"}], ",", 
       RowBox[{"Show", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Graphics3D", "[", 
           RowBox[{"ROBOT", "[", "konf", "]"}], "]"}], ",", "WORKSPACE"}], 
         "}"}]}]}], "}"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "0.5"}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y", ",", "0"}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"z", ",", "0.4"}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lr", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.674250030056346*^9, 3.6742500413049893`*^9}, {
   3.6742501199184856`*^9, 3.674250122953659*^9}, {3.67550457423757*^9, 
   3.6755045849431825`*^9}, {3.6755046404723587`*^9, 3.6755047588351283`*^9}, 
   3.680783064125492*^9}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`lr$$ = -1, $CellContext`x$$ = 
    0.5, $CellContext`y$$ = 0, $CellContext`z$$ = 0.4, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`x$$], 0.5}, -1, 1}, {{
       Hold[$CellContext`y$$], 0}, -1, 1}, {{
       Hold[$CellContext`z$$], 0.4}, -1, 1}, {{
       Hold[$CellContext`lr$$], 1}, {-1, 1}}}, Typeset`size$$ = {
    800., {434., 441.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`x$479913$$ = 
    0, $CellContext`y$479914$$ = 0, $CellContext`z$479915$$ = 
    0, $CellContext`lr$479916$$ = False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`lr$$ = 1, $CellContext`x$$ = 
        0.5, $CellContext`y$$ = 0, $CellContext`z$$ = 0.4}, 
      "ControllerVariables" :> {
        Hold[$CellContext`x$$, $CellContext`x$479913$$, 0], 
        Hold[$CellContext`y$$, $CellContext`y$479914$$, 0], 
        Hold[$CellContext`z$$, $CellContext`z$479915$$, 0], 
        Hold[$CellContext`lr$$, $CellContext`lr$479916$$, False]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`konf = \
$CellContext`InverseKinematics[$CellContext`x$$, $CellContext`y$$, \
$CellContext`z$$, $CellContext`lr$$]; Column[{
          $CellContext`MF[$CellContext`konf], 
          Show[{
            Graphics3D[
             $CellContext`ROBOT[$CellContext`konf]], \
$CellContext`WORKSPACE}]}]), 
      "Specifications" :> {{{$CellContext`x$$, 0.5}, -1, 
         1}, {{$CellContext`y$$, 0}, -1, 1}, {{$CellContext`z$$, 0.4}, -1, 
         1}, {{$CellContext`lr$$, 1}, {-1, 1}}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{861., {547., 554.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.6968382928842382`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"InverseKinematics", "[", 
    RowBox[{"x", ",", "y", ",", "z", ",", 
     RowBox[{"-", "1"}]}], "]"}], ",", 
   RowBox[{"Element", "[", 
    RowBox[{
     RowBox[{"x", "|", "y", "|", "z"}], ",", "Reals"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "@", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"InverseKinematics", "[", 
     RowBox[{"x", ",", "y", ",", "z", ",", 
      RowBox[{"-", "1"}]}], "]"}], ",", 
    RowBox[{"Element", "[", 
     RowBox[{
      RowBox[{"x", "|", "y", "|", "z"}], ",", "Reals"}], "]"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.6952403223476458`*^9, 3.6952403324652247`*^9}, {
   3.6952407793967876`*^9, 3.6952407811228867`*^9}, {3.6952409593150787`*^9, 
   3.695240975301993*^9}, 3.6952437870374193`*^9, {3.695244150092185*^9, 
   3.695244159640731*^9}, {3.695244413713263*^9, 3.69524442415386*^9}, {
   3.6952444946628933`*^9, 3.6952444951599216`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ArcTan", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "9.6088742`*^8"}], " ", "y", " ", 
        SqrtBox[
         RowBox[{"Abs", "[", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "-", 
           RowBox[{"0.28424685848545644`", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"0.4689128906808485`", "\[VeryThinSpace]", "+", 
               RowBox[{"1.`", " ", 
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", 
                  RowBox[{"Min", "[", 
                   RowBox[{"1", ",", 
                    RowBox[{"3.751303125446788`", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "0.34674685848545644`"}], "+", 
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["y", "2"]}], ")"}]}]}], "]"}]}], "]"}]}]}],
               ")"}], "2"]}]}], "]"}]]}], "+", 
       RowBox[{"x", " ", 
        RowBox[{"(", 
         RowBox[{"2.40221855`*^8", "+", 
          RowBox[{"5.12295268`*^8", " ", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"Min", "[", 
              RowBox[{"1", ",", 
               RowBox[{"3.751303125446788`", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "0.34674685848545644`"}], "+", 
                  SuperscriptBox["x", "2"], "+", 
                  SuperscriptBox["y", "2"]}], ")"}]}]}], "]"}]}], "]"}]}]}], 
         ")"}]}]}], ",", 
      RowBox[{
       RowBox[{"9.6088742`*^8", " ", "x", " ", 
        SqrtBox[
         RowBox[{"Abs", "[", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "-", 
           RowBox[{"0.28424685848545644`", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"0.4689128906808485`", "\[VeryThinSpace]", "+", 
               RowBox[{"1.`", " ", 
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", 
                  RowBox[{"Min", "[", 
                   RowBox[{"1", ",", 
                    RowBox[{"3.751303125446788`", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "0.34674685848545644`"}], "+", 
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["y", "2"]}], ")"}]}]}], "]"}]}], "]"}]}]}],
               ")"}], "2"]}]}], "]"}]]}], "+", 
       RowBox[{"y", " ", 
        RowBox[{"(", 
         RowBox[{"2.40221855`*^8", "+", 
          RowBox[{"5.12295268`*^8", " ", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"Min", "[", 
              RowBox[{"1", ",", 
               RowBox[{"3.751303125446788`", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "0.34674685848545644`"}], "+", 
                  SuperscriptBox["x", "2"], "+", 
                  SuperscriptBox["y", "2"]}], ")"}]}]}], "]"}]}], "]"}]}]}], 
         ")"}]}]}]}], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"ArcTan", "[", 
     RowBox[{
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{"1", ",", 
          RowBox[{"3.751303125446788`", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "0.34674685848545644`"}], "+", 
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"]}], ")"}]}]}], "]"}]}], "]"}], ",", 
      RowBox[{"-", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox[
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{"1", ",", 
              RowBox[{"3.751303125446788`", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "0.34674685848545644`"}], "+", 
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["y", "2"]}], ")"}]}]}], "]"}]}], "]"}], 
          "2"]}]]}]}], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Max", "[", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["243", "500"]}], ",", 
      RowBox[{"Min", "[", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"-", "0.41737`"}], "+", 
         RowBox[{"1.`", " ", "z"}]}]}], "]"}]}], "]"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6968383091111665`*^9}],

Cell[BoxData["\<\"[atan((-0.960887E9).*y.*abs(x.^2+y.^2+(-0.284247E0).*(0.\
468913E0+ ...\\n  \
0.1E1.*max((-1),min(1,0.37513E1.*((-0.346747E0)+x.^2+y.^2)))).^2) ...\\n  \
.^(1/2)+x.*(0.240222E9+0.512295E9.*max((-1),min(1,0.37513E1.*(( ...\\n  \
-0.346747E0)+x.^2+y.^2)))),0.960887E9.*x.*abs(x.^2+y.^2+( ...\\n  \
-0.284247E0).*(0.468913E0+0.1E1.*max((-1),min(1,0.37513E1.*(( ...\\n  \
-0.346747E0)+x.^2+y.^2)))).^2).^(1/2)+y.*(0.240222E9+0.512295E9.* ...\\n  \
max((-1),min(1,0.37513E1.*((-0.346747E0)+x.^2+y.^2)))));atan(max(( ...\\n  \
-1),min(1,0.37513E1.*((-0.346747E0)+x.^2+y.^2))),(-1).*(1+(-1).* ...\\n  \
max((-1),min(1,0.37513E1.*((-0.346747E0)+x.^2+y.^2))).^2).^(1/2)); ...\\n  \
max((-243/500),min(0,(-0.41737E0)+0.1E1.*z))];\\n\"\>"], "Output",
 CellChangeTimes->{3.696838314120453*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mozg\[AAcute]segyenletek", "Section",
 CellChangeTimes->{{3.674139011253525*^9, 3.674139013296642*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["q", "1"], "[", "t", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["q", "2"], "[", "t", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["q", "3"], "[", "t", "]"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Trafo", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Subscript", "[", 
     RowBox[{"T", ",", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<B\>\"", ",", 
          RowBox[{"ToString", "[", "i", "]"}]}], "}"}], "]"}], "]"}]}], "]"}],
     "[", "Q", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"KIN", "=", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{
      RowBox[{
       SubscriptBox["\[PartialD]", "t"], 
       RowBox[{"Q", "\[Transpose]"}]}], ".", 
      RowBox[{"(", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "1"}], "3"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["m", "i"], 
           RowBox[{
            RowBox[{
             SubscriptBox["Jv", "i"], "\[Transpose]"}], ".", 
            SubscriptBox["Jv", "i"]}]}], "+", 
          RowBox[{
           RowBox[{
            SubscriptBox["J\[Omega]", "i"], "\[Transpose]"}], ".", 
           RowBox[{"HM2RM", "[", 
            RowBox[{"Trafo", "[", "i", "]"}], "]"}], ".", 
           SubscriptBox["\[CapitalTheta]", "i"], ".", 
           RowBox[{
            RowBox[{"HM2RM", "[", 
             RowBox[{"Trafo", "[", "i", "]"}], "]"}], "\[Transpose]"}], ".", 
           SubscriptBox["J\[Omega]", "i"]}]}], ")"}]}], ")"}], ".", 
      RowBox[{
       SubscriptBox["\[PartialD]", "t"], "Q"}]}]}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6742944794417787`*^9, 3.674294548399723*^9}, {
   3.67429459136418*^9, 3.6742946151935434`*^9}, {3.6742957436550875`*^9, 
   3.6742957648102975`*^9}, {3.6742957992692685`*^9, 3.674295874529573*^9}, {
   3.674296628497698*^9, 3.674296661010557*^9}, 3.6742975266270676`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.4963768242676393`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.3058686121807494`", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
     RowBox[{"0.001769085068210425`", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox[
      SubscriptBox["q", "1"], "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.3752425417637384`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.30586861218074934`", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
     RowBox[{"0.0017690850682104244`", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox[
     SubscriptBox["q", "1"], "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}], " ", 
   RowBox[{
    SuperscriptBox[
     SubscriptBox["q", "2"], "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}], "+", 
  RowBox[{"0.1876212708818692`", " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox[
      SubscriptBox["q", "2"], "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
  RowBox[{"0.63193`", " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox[
      SubscriptBox["q", "3"], "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{3.696838315132511*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"POT", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"g", 
    RowBox[{"(", 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"i", "=", "1"}], "3"], 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["m", "i"], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Trafo", "[", "i", "]"}], ".", 
           RowBox[{"V2HV", "[", 
            SubscriptBox["r", "i"], "]"}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ")"}]}], ")"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6742973326839747`*^9, 3.6742973580644264`*^9}, {
  3.674297393548456*^9, 3.674297418639891*^9}, {3.6742974626704097`*^9, 
  3.674297535639583*^9}, {3.6812956885386806`*^9, 3.681295690727806*^9}}],

Cell[BoxData[
 RowBox[{"67.07442894285816`", "\[VeryThinSpace]", "+", 
  RowBox[{"12.3984666`", " ", 
   RowBox[{
    SubscriptBox["q", "3"], "[", "t", "]"}]}]}]], "Output",
 CellChangeTimes->{3.6968383152015142`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"eq", "=", 
   RowBox[{"FullSimplify", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             SubscriptBox["q", "i"], "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], ",", "t"}]], "KIN"}], 
        "-", 
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{
           SubscriptBox["q", "i"], "[", "t", "]"}]], "KIN"}], "+", 
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{
           SubscriptBox["q", "i"], "[", "t", "]"}]], "POT"}]}], "\[Equal]", 
       RowBox[{
        SubscriptBox["\[Tau]", "i"], "[", "t", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], ";", 
  RowBox[{"eq", "//", "MF"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coef", "=", 
   RowBox[{"CoefficientArrays", "[", 
    RowBox[{"eq", ",", 
     RowBox[{"Flatten", "@", 
      RowBox[{
       SubscriptBox["\[PartialD]", 
        RowBox[{"t", ",", "t"}]], "Q"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{"Normal", "@", 
    RowBox[{"coef", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "=", 
   RowBox[{
    RowBox[{"Normal", "@", 
     RowBox[{"coef", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "+", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        SubscriptBox["\[Tau]", "1"], "[", "t", "]"}], "}"}], ",", 
      RowBox[{"{", " ", 
       RowBox[{
        SubscriptBox["\[Tau]", "2"], "[", "t", "]"}], "}"}], ",", 
      RowBox[{"{", " ", 
       RowBox[{
        SubscriptBox["\[Tau]", "3"], "[", "t", "]"}], "}"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"H", "//", "MF"}], "\[IndentingNewLine]", 
 RowBox[{"h", "//", "MF"}]}], "Input",
 CellChangeTimes->{{3.6742976178032827`*^9, 3.6742976228735723`*^9}, {
  3.6742976581565905`*^9, 3.674297753394038*^9}, {3.674297799189657*^9, 
  3.674297820333867*^9}, {3.674297852509707*^9, 3.674297903881645*^9}, {
  3.6743014930929365`*^9, 3.674301588906417*^9}, {3.694973490468008*^9, 
  3.6949734916110735`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "0.00353817013642085`"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
            RowBox[{"0.6117372243614988`", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["q", "1"], "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], " ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["q", "2"], "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "0.0017690850682104244`"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
            RowBox[{"0.30586861218074934`", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox[
             SubscriptBox["q", "2"], "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"0.9927536485352786`", "\[VeryThinSpace]", "+", 
            RowBox[{"0.6117372243614988`", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
            RowBox[{"0.00353817013642085`", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["q", "1"], "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"0.3752425417637384`", "\[VeryThinSpace]", "+", 
            RowBox[{"0.30586861218074934`", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
            RowBox[{"0.0017690850682104244`", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["q", "2"], "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], "\[Equal]", 
        RowBox[{
         SubscriptBox["\[Tau]", "1"], "[", "t", "]"}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"0.001769085068210425`", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{"0.3058686121807494`", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox[
             SubscriptBox["q", "1"], "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"0.3752425417637384`", "\[VeryThinSpace]", "+", 
            RowBox[{"0.30586861218074934`", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
            RowBox[{"0.0017690850682104244`", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["q", "1"], "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"0.3752425417637384`", " ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["q", "2"], "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], "\[Equal]", 
        RowBox[{
         SubscriptBox["\[Tau]", "2"], "[", "t", "]"}]}]},
      {
       RowBox[{
        RowBox[{"12.3984666`", "\[VeryThinSpace]", "+", 
         RowBox[{"1.26386`", " ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["q", "3"], "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], "\[Equal]", 
        RowBox[{
         SubscriptBox["\[Tau]", "3"], "[", "t", "]"}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.696838318496703*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.9927536485352786`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.6117372243614988`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"0.00353817013642085`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], 
      RowBox[{"0.3752425417637384`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.30586861218074934`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"0.0017690850682104244`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], "0"},
     {
      RowBox[{"0.3752425417637384`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.30586861218074934`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"0.0017690850682104244`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], 
      "0.3752425417637384`", "0"},
     {"0", "0", "1.26386`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.696838318512704*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "0.00353817013642085`"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
          RowBox[{"0.6117372243614988`", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["q", "1"], "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["q", "2"], "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "0.0017690850682104244`"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
          RowBox[{"0.30586861218074934`", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox[
           SubscriptBox["q", "2"], "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}]}]},
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"0.001769085068210425`", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"0.3058686121807494`", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox[
           SubscriptBox["q", "1"], "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}]}]},
     {"12.3984666`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.696838318529705*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Hinv", "=", 
   RowBox[{"FullSimplify", "@", 
    RowBox[{"Chop", "@", 
     RowBox[{"Inverse", "[", "H", "]"}]}]}]}], ";", 
  RowBox[{"Hinv", "//", "MF"}]}]], "Input",
 CellChangeTimes->{{3.674647560805355*^9, 3.6746475966934075`*^9}, {
  3.6746477131460686`*^9, 3.674647716535262*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox["8.022075924901166`", 
        RowBox[{
         RowBox[{"-", "3.9536540759023837`"}], "+", 
         RowBox[{"1.`", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
         RowBox[{"0.011568001291552756`", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}]]}], 
      FractionBox[
       RowBox[{"4.010903783503054`", "\[VeryThinSpace]", "+", 
        RowBox[{"3.269377635286951`", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
        RowBox[{"0.018909449765670567`", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], 
       RowBox[{
        RowBox[{"-", "1.976760908292515`"}], "+", 
        RowBox[{"0.4999832737873858`", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{
            SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
        RowBox[{"0.005783807156927253`", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{
            SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}]], "0"},
     {
      FractionBox[
       RowBox[{"4.010903783503054`", "\[VeryThinSpace]", "+", 
        RowBox[{"3.269377635286951`", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
        RowBox[{"0.018909449765670567`", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], 
       RowBox[{
        RowBox[{"-", "1.976760908292515`"}], "+", 
        RowBox[{"0.4999832737873858`", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{
            SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
        RowBox[{"0.005783807156927253`", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{
            SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"-", "10.611375102302956`"}], "-", 
        RowBox[{"6.538755270573903`", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"0.03781889953134115`", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], 
       RowBox[{
        RowBox[{"-", "1.976760908292515`"}], "+", 
        RowBox[{"0.4999832737873858`", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{
            SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
        RowBox[{"0.005783807156927253`", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{
            SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}]], "0"},
     {"0", "0", "0.7912268763945373`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6968383190907373`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Statikus", " ", "nyomat\[EAcute]k"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\[Tau]0", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Hinv", ".", "h"}], ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         SuperscriptBox[
          SubscriptBox["q", "1"], "\[Prime]",
          MultilineFunction->None], " ", "[", "t", "]"}], "\[Rule]", "0"}], 
       ",", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          SubscriptBox["q", "2"], "\[Prime]",
          MultilineFunction->None], " ", "[", "t", "]"}], "\[Rule]", "0"}], 
       ",", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          SubscriptBox["q", "3"], "\[Prime]",
          MultilineFunction->None], " ", "[", "t", "]"}], "\[Rule]", "0"}]}], 
      "}"}]}]}], ";", 
   RowBox[{"\[Tau]0", "//", "MF"}]}]}]], "Input",
 CellChangeTimes->{{3.6755887063411055`*^9, 3.675588794849168*^9}, {
  3.6755888298881717`*^9, 3.675588877753909*^9}, {3.6756171353191495`*^9, 
  3.6756171363392076`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`"},
     {"0.`"},
     {"9.809999999999999`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6968383191317396`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"K\[UDoubleDot]ls\[ODoubleAcute]", " ", "er\[ODoubleAcute]"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "=", 
     RowBox[{"Chop", "@", 
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{"Flatten", "@", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["F", "x"], ",", 
           SubscriptBox["F", "y"], ",", 
           SubscriptBox["F", "z"], ",", "0", ",", "0", ",", "0"}], 
          RowBox[{"(*", 
           RowBox[{"cross", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Chop", "@", 
               RowBox[{"Simplify", "@", 
                RowBox[{"HM2RM", "[", 
                 RowBox[{
                  SubscriptBox["T", "BTCP"], "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["q", "1"], "[", "t", "]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["q", "2"], "[", "t", "]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["q", "3"], "[", "t", "]"}], "}"}]}], "}"}], 
                  "]"}], "]"}]}]}], ".", 
              RowBox[{"HM2P", "[", 
               RowBox[{
                SubscriptBox["T", 
                 RowBox[{"3", "TCP"}]], "[", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["F", "x"], ",", 
               SubscriptBox["F", "y"], ",", 
               SubscriptBox["F", "z"]}], "}"}]}], "]"}], "*)"}], "}"}]}], 
        "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FORCE", "=", 
     RowBox[{
      RowBox[{"Simplify", "@", 
       RowBox[{"Transpose", "[", 
        SubscriptBox["J", "TCP"], "]"}]}], ".", "f"}]}], ";", 
    RowBox[{
     RowBox[{"FORCE", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["F", "y"], "\[Rule]", "0"}], ",", 
        RowBox[{
         SubscriptBox["F", "z"], "\[Rule]", "0"}]}], "}"}]}], "//", 
     "MF"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6756214766634607`*^9, 3.675621487309069*^9}, {
   3.68054127671253*^9, 3.6805413120735526`*^9}, 3.68078417463601*^9, {
   3.680784248716247*^9, 3.680784249175273*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"0.11471528727020923`", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{
              SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
          RowBox[{"0.25`", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "[", "t", "]"}], "]"}]}], "-", 
          RowBox[{"0.5206604088577984`", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{
              SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], ")"}], 
        " ", 
        SubscriptBox["F", "x"]}]}]},
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"0.11471528727020923`", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{
              SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
          RowBox[{"0.5206604088577984`", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{
              SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], ")"}], 
        " ", 
        SubscriptBox["F", "x"]}]}]},
     {"0.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6968383191937428`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Chop", "@", 
    RowBox[{"Simplify", "@", "FORCE"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["F", "y"], "\[Rule]", "0"}], ",", 
     RowBox[{
      SubscriptBox["F", "z"], "\[Rule]", "0"}]}], "}"}]}], "//", 
  "MF"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Chop", "@", 
   RowBox[{"Simplify", "@", "f"}]}], "//", "MF"}]}], "Input",
 CellChangeTimes->{{3.6756572860903473`*^9, 3.6756573185272026`*^9}, {
  3.67565887521124*^9, 3.675658889699068*^9}, {3.6756707315813856`*^9, 
  3.67567073340049*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"0.11471528727020923`", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
         RowBox[{"0.25`", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["q", "1"], "[", "t", "]"}], "]"}]}], "-", 
         RowBox[{"0.5206604088577984`", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
       SubscriptBox["F", "x"]}]},
     {
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"0.11471528727020923`", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
         RowBox[{"0.5206604088577984`", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
       SubscriptBox["F", "x"]}]},
     {"0.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6968383192457457`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SubscriptBox["F", "x"]},
     {
      SubscriptBox["F", "y"]},
     {
      SubscriptBox["F", "z"]},
     {"0"},
     {"0"},
     {"0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6968383192697473`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Chop", "@", 
     RowBox[{"Simplify", "@", "FORCE"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["F", "y"], "\[Rule]", "0"}], ",", 
      RowBox[{
       SubscriptBox["F", "z"], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["q", "1"], "[", "t", "]"}], "\[Rule]", "a"}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["q", "2"], "[", "t", "]"}], "\[Rule]", "b"}]}], "}"}]}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "0", ",", 
     RowBox[{"2", "*", "Pi"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"b", ",", "0", ",", 
     RowBox[{"2", "*", "Pi"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.675670820668481*^9, 3.675670871647397*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a$$ = 0, $CellContext`b$$ = 0, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`a$$], 0, 2 Pi}, {
      Hold[$CellContext`b$$], 0, 2 Pi}}, Typeset`size$$ = {414., {3., 11.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`a$485722$$ = 0, $CellContext`b$485723$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`a$$ = 0, $CellContext`b$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`a$$, $CellContext`a$485722$$, 0], 
        Hold[$CellContext`b$$, $CellContext`b$485723$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ReplaceAll[
        Chop[
         Simplify[$CellContext`FORCE]], {
        Subscript[$CellContext`F, $CellContext`y] -> 0, 
         Subscript[$CellContext`F, $CellContext`z] -> 0, 
         Subscript[$CellContext`q, 1][$CellContext`t] -> $CellContext`a$$, 
         Subscript[$CellContext`q, 2][$CellContext`t] -> $CellContext`b$$}], 
      "Specifications" :> {{$CellContext`a$$, 0, 2 Pi}, {$CellContext`b$$, 0, 
         2 Pi}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{475., {84., 91.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.696838319303749*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cs\[UAcute]sz\[OAcute]m\[OAcute]d", "Section",
 CellChangeTimes->{{3.6764912812724743`*^9, 3.6764912963083344`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"tmp", "=", 
   RowBox[{"CoefficientArrays", "[", 
    RowBox[{"eq", ",", 
     RowBox[{"Flatten", "@", 
      RowBox[{"D", "[", 
       RowBox[{"Q", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"Normal", "@", 
    RowBox[{"tmp", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}], ";", 
  RowBox[{"M", "//", "MF"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmp", "=", " ", 
   RowBox[{"Normal", "@", 
    RowBox[{"tmp", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmp", "=", 
   RowBox[{"CoefficientArrays", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", 
      RowBox[{"equal", "[", 
       RowBox[{"tmp", ",", "NullVec"}], "]"}]}], ",", 
     RowBox[{"Flatten", "@", 
      RowBox[{"D", "[", 
       RowBox[{"Q", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "1"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"\"\<Symmetric\>\"", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"Simplify", "@", 
    RowBox[{"SparseArray", "[", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "j"}], "}"}], "\[Rule]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Flatten", "@", 
               RowBox[{"Transpose", "@", 
                RowBox[{"D", "[", 
                 RowBox[{"Q", ",", 
                  RowBox[{"{", 
                   RowBox[{"t", ",", "1"}], "}"}]}], "]"}]}]}], ".", 
              RowBox[{"Normal", "@", 
               RowBox[{"tmp", "[", 
                RowBox[{"[", 
                 RowBox[{"3", ",", "i"}], "]"}], "]"}]}]}], ")"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "]"}]}]}], ";", 
  RowBox[{"B", "//", "MF"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmp", "=", 
   RowBox[{"Normal", "@", 
    RowBox[{"tmp", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmp", "=", 
   RowBox[{"CoefficientArrays", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Flatten", "@", 
       RowBox[{"equal", "[", 
        RowBox[{
         RowBox[{"Transpose", "@", 
          RowBox[{"{", "tmp", "}"}]}], ",", "NullVec"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Tau]", "1"], "[", "t", "]"}], ",", 
       RowBox[{
        SubscriptBox["\[Tau]", "2"], "[", "t", "]"}], ",", 
       RowBox[{
        SubscriptBox["\[Tau]", "3"], "[", "t", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gg", "=", 
   RowBox[{"Transpose", "@", 
    RowBox[{"Normal", "@", 
     RowBox[{"tmp", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", 
        RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}]}]}], ";", 
  RowBox[{"gg", "//", "MF"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tau", "=", 
   RowBox[{"Transpose", "@", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Tau]", "1"], "[", "t", "]"}], ",", 
       RowBox[{
        SubscriptBox["\[Tau]", "2"], "[", "t", "]"}], ",", 
       RowBox[{
        SubscriptBox["\[Tau]", "3"], "[", "t", "]"}]}], "}"}], "}"}]}]}], ";", 
  RowBox[{"tau", "//", "MF"}]}]}], "Input",
 CellChangeTimes->{{3.6764912994635143`*^9, 3.6764913058078775`*^9}, {
   3.676491347060237*^9, 3.6764914390755*^9}, {3.6765367103552113`*^9, 
   3.6765367945200253`*^9}, {3.6810592822528625`*^9, 
   3.6810593740541134`*^9}, {3.6810594067379827`*^9, 3.681059494792019*^9}, {
   3.681059537062437*^9, 3.681059550737219*^9}, {3.6810596473947477`*^9, 
   3.681059674768313*^9}, {3.681059773549963*^9, 3.681059824130856*^9}, {
   3.6810600170638914`*^9, 3.681060033407826*^9}, {3.6810600713199944`*^9, 
   3.681060209813916*^9}, {3.6810602969088974`*^9, 3.681060340455388*^9}, {
   3.6810603716191707`*^9, 3.6810604622833567`*^9}, {3.6810604943141885`*^9, 
   3.6810605041817527`*^9}, {3.6810609558705883`*^9, 3.681060979915963*^9}, {
   3.6810611808414555`*^9, 3.6810612594559517`*^9}, {3.6810614998897038`*^9, 
   3.6810615011207743`*^9}, {3.6810615452142963`*^9, 3.681061585050575*^9}, {
   3.681148457071394*^9, 3.681148457333409*^9}, 3.6811489836725135`*^9, {
   3.681149117613175*^9, 3.6811491189202495`*^9}, 3.6811491571914387`*^9, {
   3.681149220877081*^9, 3.681149221086093*^9}, {3.681150267313934*^9, 
   3.681150279791648*^9}, {3.6811506842577815`*^9, 3.6811506849008183`*^9}, {
   3.681295993804141*^9, 3.681296002111616*^9}, {3.6812966907780056`*^9, 
   3.6812966951862574`*^9}, 3.6812992151193895`*^9, {3.6812993603816977`*^9, 
   3.6812993810838823`*^9}, 3.6812995352436996`*^9, 3.681299571767789*^9, {
   3.681310063953582*^9, 3.6813100663217173`*^9}, {3.6813153035194597`*^9, 
   3.6813153096478105`*^9}, {3.6949741171948547`*^9, 3.6949741228011756`*^9}, 
   3.69497418284861*^9, 3.6949742377647514`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.9927536485352786`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.6117372243614988`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"0.00353817013642085`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], 
      RowBox[{"0.3752425417637384`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.30586861218074934`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"0.0017690850682104244`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], "0"},
     {
      RowBox[{"0.3752425417637384`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.30586861218074934`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"0.0017690850682104244`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], 
      "0.3752425417637384`", "0"},
     {"0", "0", "1.26386`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6968383199477863`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "0.001769085068210425`"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"1.`", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{"172.89649756083276`", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["q", "2"], "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "0.001769085068210425`"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
          RowBox[{"0.3058686121807494`", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["q", "1"], "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "0.0017690850682104244`"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
          RowBox[{"0.30586861218074934`", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["q", "2"], "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], "0"},
     {
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"0.001769085068210425`", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{"0.3058686121807494`", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["q", "1"], "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], "0", "0"},
     {"0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {3, 3}, 0, {
     1, {{0, 2, 3, 3}, {{1}, {2}, {
       1}}}, {(-0.001769085068210425) (
        1. Cos[Subscript[$CellContext`q, 2][$CellContext`t]] + 
        172.89649756083276` Sin[Subscript[$CellContext`q, 2][$CellContext`t]])
         Derivative[1][
        Subscript[$CellContext`q, 
          2]][$CellContext`t], ((-0.001769085068210425) 
          Cos[Subscript[$CellContext`q, 2][$CellContext`t]] - 
         0.3058686121807494 Sin[Subscript[$CellContext`q, 2][$CellContext`t]])
          Derivative[1][
         Subscript[$CellContext`q, 
           1]][$CellContext`t] + ((-0.0017690850682104244`) 
          Cos[Subscript[$CellContext`q, 2][$CellContext`t]] - 
         0.30586861218074934` 
         Sin[Subscript[$CellContext`q, 2][$CellContext`t]]) 
        Derivative[1][Subscript[$CellContext`q, 2]][$CellContext`t], (
        0.001769085068210425 
         Cos[Subscript[$CellContext`q, 2][$CellContext`t]] + 
        0.3058686121807494 Sin[Subscript[$CellContext`q, 2][$CellContext`t]]) 
       Derivative[1][
        Subscript[$CellContext`q, 1]][$CellContext`t]}}]]]]], "Output",
 CellChangeTimes->{3.6968383201167955`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0"},
     {"0"},
     {"12.3984666`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6968383201297965`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SubscriptBox["\[Tau]", "1"], "[", "t", "]"}]},
     {
      RowBox[{
       SubscriptBox["\[Tau]", "2"], "[", "t", "]"}]},
     {
      RowBox[{
       SubscriptBox["\[Tau]", "3"], "[", "t", "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.696838320141797*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"equal", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"M", ".", 
       RowBox[{"D", "[", 
        RowBox[{"Q", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "+", 
      RowBox[{"B", ".", 
       RowBox[{"D", "[", 
        RowBox[{"Q", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "1"}], "}"}]}], "]"}]}], "+", "gg"}], ",", 
     "tau"}], "]"}], "//", "Simplify"}], "//", "MF"}], "\[IndentingNewLine]", 
 RowBox[{"eq", "//", "MF"}]}], "Input",
 CellChangeTimes->{{3.681061686612384*^9, 3.6810616881874743`*^9}, {
   3.6811484891332273`*^9, 3.68114859512429*^9}, {3.681150510550846*^9, 
   3.6811506127486916`*^9}, 3.6811508943097963`*^9, {3.6811509399194045`*^9, 
   3.6811509540652137`*^9}, {3.6811510181898813`*^9, 
   3.6811510294385247`*^9}, {3.6811512436477766`*^9, 
   3.6811512931746097`*^9}, {3.6811513245744057`*^9, 
   3.6811514274112873`*^9}, {3.6811516869461317`*^9, 3.681151696968705*^9}, 
   3.6812968607177258`*^9, {3.6812969533860254`*^9, 3.6812969896260986`*^9}, {
   3.681297116843375*^9, 3.6812971289030647`*^9}, {3.681299463536598*^9, 
   3.6812994636936073`*^9}, {3.6813100592633133`*^9, 
   3.6813100595373287`*^9}, {3.6949741579641867`*^9, 3.6949741607343454`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "0.00353817013642085`"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
           RowBox[{"0.6117372243614988`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["q", "1"], "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["q", "2"], "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "0.0017690850682104244`"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
           RowBox[{"0.30586861218074934`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox[
            SubscriptBox["q", "2"], "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
        RowBox[{"0.9927536485352786`", " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["q", "1"], "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{"0.6117372243614988`", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["q", "1"], "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "-", 
        RowBox[{"0.00353817013642085`", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["q", "1"], "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{"0.3752425417637384`", " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["q", "2"], "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{"0.30586861218074934`", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["q", "2"], "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "-", 
        RowBox[{"0.0017690850682104244`", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["q", "2"], "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], "\[Equal]", 
       RowBox[{
        SubscriptBox["\[Tau]", "1"], "[", "t", "]"}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"0.001769085068210425`", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"0.3058686121807494`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox[
            SubscriptBox["q", "1"], "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"0.3752425417637384`", "\[VeryThinSpace]", "+", 
           RowBox[{"0.30586861218074934`", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
           RowBox[{"0.0017690850682104244`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["q", "1"], "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{"0.3752425417637384`", " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["q", "2"], "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], "\[Equal]", 
       RowBox[{
        SubscriptBox["\[Tau]", "2"], "[", "t", "]"}]}]},
     {
      RowBox[{
       RowBox[{"12.3984666`", "\[VeryThinSpace]", "+", 
        RowBox[{"1.26386`", " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["q", "3"], "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], "\[Equal]", 
       RowBox[{
        SubscriptBox["\[Tau]", "3"], "[", "t", "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6968383204278135`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "0.00353817013642085`"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
            RowBox[{"0.6117372243614988`", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["q", "1"], "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], " ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["q", "2"], "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "0.0017690850682104244`"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
            RowBox[{"0.30586861218074934`", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox[
             SubscriptBox["q", "2"], "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"0.9927536485352786`", "\[VeryThinSpace]", "+", 
            RowBox[{"0.6117372243614988`", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
            RowBox[{"0.00353817013642085`", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["q", "1"], "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"0.3752425417637384`", "\[VeryThinSpace]", "+", 
            RowBox[{"0.30586861218074934`", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
            RowBox[{"0.0017690850682104244`", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["q", "2"], "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], "\[Equal]", 
        RowBox[{
         SubscriptBox["\[Tau]", "1"], "[", "t", "]"}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"0.001769085068210425`", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{"0.3058686121807494`", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox[
             SubscriptBox["q", "1"], "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"0.3752425417637384`", "\[VeryThinSpace]", "+", 
            RowBox[{"0.30586861218074934`", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
            RowBox[{"0.0017690850682104244`", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["q", "1"], "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"0.3752425417637384`", " ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["q", "2"], "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], "\[Equal]", 
        RowBox[{
         SubscriptBox["\[Tau]", "2"], "[", "t", "]"}]}]},
      {
       RowBox[{
        RowBox[{"12.3984666`", "\[VeryThinSpace]", "+", 
         RowBox[{"1.26386`", " ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["q", "3"], "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], "\[Equal]", 
        RowBox[{
         SubscriptBox["\[Tau]", "3"], "[", "t", "]"}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.696838320433814*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"dM", "/", "dt"}], " ", "-", " ", 
    RowBox[{"2", "B", " ", "skew", " ", "symmetric"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"M", ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "1"}], "}"}]}], "]"}], "-", 
     RowBox[{"2", "*", "B"}]}], "//", "Simplify"}], "//", "MF"}]}]], "Input",
 CellChangeTimes->{{3.681151045665453*^9, 3.6811510500757055`*^9}, {
  3.6811514406290436`*^9, 3.6811514473254266`*^9}, {3.6811517298785877`*^9, 
  3.6811517322307224`*^9}, {3.6812994613174715`*^9, 3.6812995146125193`*^9}, {
  3.681301395780116*^9, 3.6813014089838715`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"0.0035381701364208505`", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"0.6117372243614988`", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["q", "1"], "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"0.0017690850682104244`", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"0.30586861218074934`", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["q", "2"], "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], "0"},
     {
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "0.00353817013642085`"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
          RowBox[{"0.6117372243614988`", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["q", "1"], "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "0.0017690850682104244`"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
          RowBox[{"0.30586861218074934`", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["q", "2"], "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], "0", "0"},
     {"0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6968383205328197`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["x", "wall"], "=", "0.4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalPhi]", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["pos", "TCP"], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
      SubscriptBox["x", "wall"]}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "1"], "\[Rule]", 
       RowBox[{
        SubscriptBox["q", "1"], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["q", "2"], "\[Rule]", 
       RowBox[{
        SubscriptBox["q", "2"], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["q", "3"], "\[Rule]", 
       RowBox[{
        SubscriptBox["q", "3"], "[", "t", "]"}]}]}], "}"}]}]}], ";", 
  RowBox[{"\[CapitalPhi]", "//", "MF"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["A", "full"], "=", 
   RowBox[{"{", 
    RowBox[{"D", "[", 
     RowBox[{"\[CapitalPhi]", ",", 
      RowBox[{"Transpose", "@", "Q"}]}], "]"}], "}"}]}], ";", 
  RowBox[{
   SubscriptBox["A", "full"], "//", "MF"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["A", "1"], "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["A", "full"], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["A", "2"], "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["A", "full"], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.681301500261092*^9, 3.6813015997947855`*^9}, {
  3.6813016309705687`*^9, 3.6813016362538705`*^9}, {3.6813026235003376`*^9, 
  3.681302667718867*^9}, {3.6813027583270493`*^9, 3.681302814561266*^9}, {
  3.6813028831861906`*^9, 3.6813030134836435`*^9}, {3.6813070939577074`*^9, 
  3.681307122280328*^9}, {3.681307357804799*^9, 3.681307370795542*^9}, {
  3.681307443714712*^9, 3.681307488832293*^9}, {3.681307951580761*^9, 
  3.681307978246286*^9}, {3.6813081876382627`*^9, 3.681308220903165*^9}, {
  3.681308545561734*^9, 3.681308556882382*^9}, {3.681311222106016*^9, 
  3.6813112262302523`*^9}, {3.6813112650934753`*^9, 3.6813112945981627`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{
   RowBox[{"-", "0.4`"}], "+", 
   RowBox[{"0.25`", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      SubscriptBox["q", "1"], "[", "t", "]"}], "]"}]}], "+", 
   RowBox[{"0.5206604088577984`", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
      RowBox[{
       SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "+", 
   RowBox[{"0.11471528727020923`", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
      RowBox[{
       SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6968383205678215`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"0.11471528727020923`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
       RowBox[{"0.25`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"0.5206604088577984`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{
       RowBox[{"0.11471528727020923`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
       RowBox[{"0.5206604088577984`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6968383205848227`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"FF", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"Simplify", "@", 
      RowBox[{"Flatten", "[", 
       RowBox[{"-", 
        RowBox[{
         RowBox[{"Inverse", "[", 
          SubscriptBox["A", "2"], "]"}], ".", 
         SubscriptBox["A", "1"]}]}], "]"}]}]}], "}"}]}], ";", 
  RowBox[{"FF", "//", "MF"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EE", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Inverse", "[", 
       SubscriptBox["A", "2"], "]"}]}]}], "}"}]}], ";", 
  RowBox[{"EE", "//", "MF"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TT", "=", 
   RowBox[{"IdentityMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TT", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "=", "FF"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TT", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", "3", "}"}]}], "]"}], "]"}], "=", "EE"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Inverse", "[", "TT", "]"}], "//", "FullSimplify"}], "//", 
  "MF"}]}], "Input",
 CellChangeTimes->{{3.681308195074688*^9, 3.6813081956557207`*^9}, {
  3.681308226567489*^9, 3.6813082508648787`*^9}, {3.681308299037634*^9, 
  3.681308323005005*^9}, {3.681308424184792*^9, 3.681308487889436*^9}, {
  3.681308569770119*^9, 3.6813085776115675`*^9}, {3.68130861506671*^9, 
  3.681308664450535*^9}, {3.6813087601170063`*^9, 3.6813087644882565`*^9}, {
  3.6813091507513494`*^9, 3.681309164877157*^9}, {3.6813092216684055`*^9, 
  3.681309268999113*^9}, {3.6813093508267927`*^9, 3.68130935392297*^9}, {
  3.6813095121660213`*^9, 3.681309512974067*^9}, {3.681309544347862*^9, 
  3.681309546995013*^9}, {3.681310035534956*^9, 3.6813100357169666`*^9}, {
  3.681310072061045*^9, 3.6813100768003163`*^9}, {3.6951371545747366`*^9, 
  3.6951371589719877`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0"},
     {"0", "1"},
     {
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "1.`"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
           RowBox[{
            SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "+", 
        RowBox[{"2.1793084945263725`", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"4.538718607149496`", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
           RowBox[{
            SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], 
       RowBox[{
        RowBox[{"1.`", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
           RowBox[{
            SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
        RowBox[{"4.538718607149496`", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
           RowBox[{
            SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}]], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.696838320658827*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0"},
     {"0"},
     {
      FractionBox["1", 
       RowBox[{
        RowBox[{"0.11471528727020923`", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
           RowBox[{
            SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
        RowBox[{"0.5206604088577984`", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
           RowBox[{
            SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6968383206608267`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0"},
     {"0", "1", "0"},
     {
      RowBox[{
       RowBox[{"0.11471528727020923`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
       RowBox[{"0.25`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"0.5206604088577984`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], "0", 
      RowBox[{
       RowBox[{"0.11471528727020923`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
       RowBox[{"0.5206604088577984`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6968383207398314`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"MMM", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", "TT", "]"}], ".", 
    RowBox[{"M", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "3", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "]"}], "]"}], ".", 
    "TT"}]}], ";", 
  RowBox[{"MMM", "//", "MF"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BBB", "=", 
   RowBox[{"Chop", "@", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", "TT", "]"}], ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"B", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "3", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "]"}], "]"}], "-", 
        RowBox[{
         RowBox[{"M", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "3", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "]"}], "]"}], ".", 
         "EE", ".", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["A", "full"], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "1"}], "}"}]}], "]"}]}]}], ")"}], ".", "TT"}], 
     "]"}]}]}], ";", 
  RowBox[{"BBB", "//", "MF"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ggg", "=", 
   RowBox[{"Chop", "@", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", "TT", "]"}], ".", 
      RowBox[{"gg", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "3", ",", "2"}], "}"}], ",", "All"}], "]"}], 
       "]"}]}], "]"}]}]}], ";", 
  RowBox[{"ggg", "//", "MF"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tau3", "=", 
   RowBox[{"Chop", "@", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", "TT", "]"}], ".", 
      RowBox[{"tau", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "3", ",", "2"}], "}"}], ",", "All"}], "]"}], 
       "]"}]}], "]"}]}]}], ";", 
  RowBox[{"tau3", "//", "MF"}]}]}], "Input",
 CellChangeTimes->{{3.6813110604907722`*^9, 3.6813111820217237`*^9}, {
   3.681311316721428*^9, 3.6813113206526527`*^9}, {3.681311400392214*^9, 
   3.6813114020283074`*^9}, {3.681311489728324*^9, 3.6813115747181845`*^9}, {
   3.6813116318834543`*^9, 3.68131163320953*^9}, {3.6813142508822527`*^9, 
   3.6813143048543396`*^9}, {3.6813143431105275`*^9, 3.681314383243823*^9}, {
   3.681314441508156*^9, 3.6813144425872173`*^9}, {3.6813145535565643`*^9, 
   3.681314575020792*^9}, {3.6813147390751753`*^9, 3.681314764240615*^9}, 
   3.681314807178071*^9, {3.6813148379618316`*^9, 3.681314841451031*^9}, {
   3.681385054538112*^9, 3.68138506026644*^9}, {3.681385248267193*^9, 
   3.6813852690873833`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.9927536485352786`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.6117372243614988`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"0.00353817013642085`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"0.3752425417637384`", "\[VeryThinSpace]", "+", 
           RowBox[{"0.30586861218074934`", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
           RowBox[{"0.0017690850682104244`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1.`"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "+", 
           RowBox[{"2.1793084945263725`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              SubscriptBox["q", "1"], "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"4.538718607149496`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"1.`", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
         RowBox[{"4.538718607149496`", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1.`"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "+", 
           RowBox[{"2.1793084945263725`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              SubscriptBox["q", "1"], "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"4.538718607149496`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], ")"}], 
         " ", 
         RowBox[{"(", 
          RowBox[{"0.3752425417637384`", "\[VeryThinSpace]", "+", 
           RowBox[{"0.30586861218074934`", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
           RowBox[{"0.0017690850682104244`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "+", 
           FractionBox[
            RowBox[{"0.3752425417637384`", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1.`"}], " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
                  RowBox[{
                   SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "+", 
               RowBox[{"2.1793084945263725`", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{
                  SubscriptBox["q", "1"], "[", "t", "]"}], "]"}]}], "+", 
               RowBox[{"4.538718607149496`", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
                  RowBox[{
                   SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], 
              ")"}]}], 
            RowBox[{
             RowBox[{"1.`", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{
                 SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
                RowBox[{
                 SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
             RowBox[{"4.538718607149496`", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{
                 SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
                RowBox[{
                 SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}]]}], 
          ")"}]}], 
        RowBox[{
         RowBox[{"1.`", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
         RowBox[{"4.538718607149496`", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}]]}], "0.`", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       FractionBox[
        RowBox[{"0.3752425417637384`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.30586861218074934`", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
         RowBox[{"0.0017690850682104244`", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "+", 
         FractionBox[
          RowBox[{"0.3752425417637384`", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1.`"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{
                 SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
                RowBox[{
                 SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "+", 
             RowBox[{"2.1793084945263725`", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                SubscriptBox["q", "1"], "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"4.538718607149496`", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{
                 SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
                RowBox[{
                 SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], 
            ")"}]}], 
          RowBox[{
           RowBox[{"1.`", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
           RowBox[{"4.538718607149496`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}]]}], 
        RowBox[{
         RowBox[{"0.11471528727020923`", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
         RowBox[{"0.5206604088577984`", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}]]}]},
     {"0.`", "1.26386`", "0.`"},
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       FractionBox[
        RowBox[{"0.3752425417637384`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.30586861218074934`", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
         RowBox[{"0.0017690850682104244`", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], 
        RowBox[{
         RowBox[{"0.11471528727020923`", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
         RowBox[{"0.5206604088577984`", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}]], "+", 
       FractionBox[
        RowBox[{"0.3752425417637384`", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1.`"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "+", 
           RowBox[{"2.1793084945263725`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              SubscriptBox["q", "1"], "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"4.538718607149496`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"1.`", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
           RowBox[{"4.538718607149496`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], ")"}], 
         " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"0.11471528727020923`", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
           RowBox[{"0.5206604088577984`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], 
          ")"}]}]]}], "0.`", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       FractionBox["0.3752425417637384`", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"0.11471528727020923`", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
           RowBox[{"0.5206604088577984`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], ")"}], 
         "2"]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.696838320772833*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "0.4448498736528026`"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["q", "1"], "[", "t", "]"}], "-", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "+", 
           RowBox[{"4.386427736049077`", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
           RowBox[{"3.2749957976617754`", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
              RowBox[{"3", " ", 
               RowBox[{
                SubscriptBox["q", "2"], "[", "t", "]"}]}]}], "]"}]}], "+", 
           RowBox[{"0.9119047773364433`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["q", "1"], "[", "t", "]"}], "-", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
           RowBox[{"0.6613388355047911`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
           RowBox[{"1.493822870026888`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
              RowBox[{"3", " ", 
               RowBox[{
                SubscriptBox["q", "2"], "[", "t", "]"}]}]}], "]"}]}]}], ")"}],
          " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["q", "1"], "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "5.621731310956918`"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["q", "1"], "[", "t", "]"}], "-", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "+", 
           RowBox[{"4.386427736049076`", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "+", 
           RowBox[{"1.2353035749078396`", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"3", " ", 
               RowBox[{
                SubscriptBox["q", "1"], "[", "t", "]"}]}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "+", 
           RowBox[{"0.4247238418190824`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["q", "1"], "[", "t", "]"}], "-", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
           RowBox[{"0.6613388355047918`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "+", 
           RowBox[{"1.0860626773238744`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"3", " ", 
               RowBox[{
                SubscriptBox["q", "1"], "[", "t", "]"}]}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], ")"}], 
         " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["q", "2"], "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1.`", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{
              SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
          RowBox[{"4.538718607149496`", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{
              SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], ")"}], 
        "3"]], "0", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3.397790734552662`", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"8.688501418590999`", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{
                SubscriptBox["q", "1"], "[", "t", "]"}]}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
           RowBox[{"44.973850487655355`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
           RowBox[{"9.882428599262715`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{
                SubscriptBox["q", "1"], "[", "t", "]"}]}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], ")"}], 
         " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["q", "1"], "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3.3977907345526615`", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"8.688501418590995`", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{
                SubscriptBox["q", "1"], "[", "t", "]"}]}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
           RowBox[{"44.97385048765534`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
           RowBox[{"9.882428599262711`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{
                SubscriptBox["q", "1"], "[", "t", "]"}]}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], ")"}], 
         " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["q", "2"], "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1.`", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{
              SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
          RowBox[{"4.538718607149496`", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{
              SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], ")"}], 
        "3"]]},
     {"0", "0", "0"},
     {
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"7.295238218691542`", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
           RowBox[{"6.126422201502867`", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{
                SubscriptBox["q", "1"], "[", "t", "]"}]}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "+", 
           RowBox[{"5.975291480107554`", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{
                SubscriptBox["q", "1"], "[", "t", "]"}]}], "+", 
              RowBox[{"3", " ", 
               RowBox[{
                SubscriptBox["q", "2"], "[", "t", "]"}]}]}], "]"}]}], "-", 
           RowBox[{"3.558798989222417`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"13.02998921244432`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{
                SubscriptBox["q", "1"], "[", "t", "]"}]}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
           RowBox[{"13.099983190647105`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{
                SubscriptBox["q", "1"], "[", "t", "]"}]}], "+", 
              RowBox[{"3", " ", 
               RowBox[{
                SubscriptBox["q", "2"], "[", "t", "]"}]}]}], "]"}]}]}], ")"}],
          " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["q", "1"], "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3.5643429844147336`", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
           RowBox[{"3.5643429844147336`", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{
                SubscriptBox["q", "1"], "[", "t", "]"}]}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
           RowBox[{"16.177549825625924`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"16.177549825625924`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{
                SubscriptBox["q", "1"], "[", "t", "]"}]}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], ")"}], 
         " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["q", "2"], "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1.`", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{
              SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
          RowBox[{"4.538718607149496`", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{
              SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], ")"}], 
        "3"]], "0", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"129.42039860500734`", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{
              SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "+", 
          RowBox[{"28.514743875317862`", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{
              SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], ")"}], 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            SubscriptBox["q", "1"], "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "+", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["q", "2"], "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1.`", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{
              SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
          RowBox[{"4.538718607149496`", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{
              SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
             RowBox[{
              SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], ")"}], 
        "3"]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.696838323354981*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0"},
     {"12.3984666`"},
     {"0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.696838323358981*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        SubscriptBox["\[Tau]", "1"], "[", "t", "]"}], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1.`"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "+", 
           RowBox[{"2.1793084945263725`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              SubscriptBox["q", "1"], "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"4.538718607149496`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
              RowBox[{
               SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}], ")"}], 
         " ", 
         RowBox[{
          SubscriptBox["\[Tau]", "2"], "[", "t", "]"}]}], 
        RowBox[{
         RowBox[{"1.`", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
         RowBox[{"4.538718607149496`", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}]]}]},
     {
      RowBox[{
       SubscriptBox["\[Tau]", "3"], "[", "t", "]"}]},
     {
      FractionBox[
       RowBox[{
        SubscriptBox["\[Tau]", "2"], "[", "t", "]"}], 
       RowBox[{
        RowBox[{"0.11471528727020923`", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
           RowBox[{
            SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
        RowBox[{"0.5206604088577984`", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["q", "1"], "[", "t", "]"}], "+", 
           RowBox[{
            SubscriptBox["q", "2"], "[", "t", "]"}]}], "]"}]}]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6968383234259853`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Skew", "-", 
    RowBox[{"symmetric", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{
      RowBox[{"Chop", "@", 
       RowBox[{"Simplify", "@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"MMM", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "1"}], "}"}]}], "]"}], "-", 
          RowBox[{"2", "*", "BBB"}]}], ")"}]}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["q", "1"], "[", "t", "]"}], "\[Rule]", "a"}], ",", 
        RowBox[{
         RowBox[{
          SubscriptBox["q", "2"], "[", "t", "]"}], "\[Rule]", "b"}], ",", 
        RowBox[{
         RowBox[{
          SubscriptBox["q", "3"], "[", "t", "]"}], "\[Rule]", "c"}]}], 
       "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "0", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"b", ",", "0", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c", ",", "0", ",", "1"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6813114184542465`*^9, 3.681311471411276*^9}, {
  3.6813122036121554`*^9, 3.681312406072736*^9}, {3.6813125202242646`*^9, 
  3.6813125446346607`*^9}, {3.68131433283894*^9, 3.681314334846055*^9}, {
  3.6813852904266043`*^9, 3.681385292844743*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a$$ = 0, $CellContext`b$$ = 
    0, $CellContext`c$$ = 0, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`a$$], 0, 1}, {
      Hold[$CellContext`b$$], 0, 1}, {
      Hold[$CellContext`c$$], 0, 1}}, Typeset`size$$ = {705., {24.5, 31.5}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`a$486000$$ = 0, $CellContext`b$486001$$ = 
    0, $CellContext`c$486002$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`a$$ = 0, $CellContext`b$$ = 
        0, $CellContext`c$$ = 0}, "ControllerVariables" :> {
        Hold[$CellContext`a$$, $CellContext`a$486000$$, 0], 
        Hold[$CellContext`b$$, $CellContext`b$486001$$, 0], 
        Hold[$CellContext`c$$, $CellContext`c$486002$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> MatrixForm[
        ReplaceAll[
         Chop[
          Simplify[
          D[$CellContext`MMM, {$CellContext`t, 1}] - 2 $CellContext`BBB]], {
         Subscript[$CellContext`q, 1][$CellContext`t] -> $CellContext`a$$, 
          Subscript[$CellContext`q, 2][$CellContext`t] -> $CellContext`b$$, 
          Subscript[$CellContext`q, 3][$CellContext`t] -> $CellContext`c$$}]],
       "Specifications" :> {{$CellContext`a$$, 0, 1}, {$CellContext`b$$, 0, 
         1}, {$CellContext`c$$, 0, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{766., {121., 128.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.6968383235539923`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["MatLab import", "Section",
 CellChangeTimes->{{3.674139011253525*^9, 3.674139013296642*^9}, {
  3.6754972424382153`*^9, 3.675497247571509*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"replacerule", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["q", "1"], "[", "t", "]"}], "\[Rule]", "q1"}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "2"], "[", "t", "]"}], "\[Rule]", "q2"}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "3"], "[", "t", "]"}], "\[Rule]", "q3"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "[", 
  RowBox[{"H", "/.", "replacerule"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"replacerule", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["q", "1"], "[", "t", "]"}], "\[Rule]", "q1"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        SubscriptBox["q", "1"], "\[Prime]",
        MultilineFunction->None], " ", "[", "t", "]"}], "\[Rule]", "qD1"}], 
     ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "2"], "[", "t", "]"}], "\[Rule]", "q2"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        SubscriptBox["q", "2"], "\[Prime]",
        MultilineFunction->None], " ", "[", "t", "]"}], "\[Rule]", "qD2"}], 
     ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "3"], "[", "t", "]"}], "\[Rule]", "q3"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        SubscriptBox["q", "3"], "\[Prime]",
        MultilineFunction->None], " ", "[", "t", "]"}], "\[Rule]", "qD3"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "[", 
  RowBox[{
   RowBox[{"Chop", "@", "h"}], "/.", "replacerule"}], "]"}]}], "Input",
 CellChangeTimes->{{3.675355092070937*^9, 3.675355130812153*^9}, {
  3.675355344980403*^9, 3.675355399338512*^9}, {3.6754972804923916`*^9, 
  3.6754972870087643`*^9}}],

Cell[BoxData["\<\"[0.992754E0+0.611737E0.*cos(q2)+(-0.353817E-2).*sin(q2), \
...\\n  0.375243E0+0.305869E0.*cos(q2)+(-0.176909E-2).*sin(q2),0; ...\\n  \
0.375243E0+0.305869E0.*cos(q2)+(-0.176909E-2).*sin(q2),0.375243E0, ...\\n  \
0;0,0,0.126386E1];\\n\"\>"], "Output",
 CellChangeTimes->{3.696838326009133*^9}],

Cell[BoxData["\<\"[qD1.*qD2.*((-0.353817E-2).*cos(q2)+(-0.611737E0).*sin(q2))+\
 ...\\n  qD2.^2.*((-0.176909E-2).*cos(q2)+(-0.305869E0).*sin(q2));qD1.^2.*( \
...\\n  0.176909E-2.*cos(q2)+0.305869E0.*sin(q2));0.123985E2];\\n\"\>"], \
"Output",
 CellChangeTimes->{3.696838326029134*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"replacerule", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "1"], "\[Rule]", "q1"}], ",", 
     RowBox[{
      SubscriptBox["q", "2"], "\[Rule]", "q2"}], ",", 
     RowBox[{
      SubscriptBox["q", "3"], "\[Rule]", "q3"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "[", 
  RowBox[{
   SubscriptBox["pos", "TCP"], "/.", "replacerule"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"replacerule", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["q", "1"], "[", "t", "]"}], "\[Rule]", "q1"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        SubscriptBox["q", "1"], "\[Prime]",
        MultilineFunction->None], " ", "[", "t", "]"}], "\[Rule]", "qD1"}], 
     ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "2"], "[", "t", "]"}], "\[Rule]", "q2"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        SubscriptBox["q", "2"], "\[Prime]",
        MultilineFunction->None], " ", "[", "t", "]"}], "\[Rule]", "qD2"}], 
     ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "3"], "[", "t", "]"}], "\[Rule]", "q3"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        SubscriptBox["q", "3"], "\[Prime]",
        MultilineFunction->None], " ", "[", "t", "]"}], "\[Rule]", "qD3"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "[", 
  RowBox[{
   SubscriptBox["Jv", "TCP"], "/.", "replacerule"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "[", 
  RowBox[{
   SubscriptBox["J\[Omega]", "TCP"], "/.", "replacerule"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6754973757068377`*^9, 3.6754973761578636`*^9}, {
  3.675497456995487*^9, 3.675497553293995*^9}, {3.675499464202293*^9, 
  3.6754994643212996`*^9}, {3.675500731049752*^9, 3.6755007323608274`*^9}, {
  3.67550079640149*^9, 3.6755007970835295`*^9}, {3.6756577361670904`*^9, 
  3.675657746445678*^9}}],

Cell[BoxData["\<\"[0.25E0.*cos(q1)+0.52066E0.*cos(q1+q2)+0.114715E0.*sin(q1+\
q2);( ...\\n  -0.114715E0).*cos(q1+q2)+0.25E0.*sin(q1)+0.52066E0.*sin(q1+q2); \
...\\n  0.41737E0+0.1E1.*q3];\\n\"\>"], "Output",
 CellChangeTimes->{3.6968383260851374`*^9}],

Cell[BoxData["\<\"[0.114715E0.*cos(q1+q2)+(-0.25E0).*sin(q1)+(-0.52066E0).*\
sin(q1+ ...\\n  \
q2),0.114715E0.*cos(q1+q2)+(-0.52066E0).*sin(q1+q2),0;0.25E0.*cos( ...\\n  \
q1)+0.52066E0.*cos(q1+q2)+0.114715E0.*sin(q1+q2),0.52066E0.*cos( ...\\n  \
q1+q2)+0.114715E0.*sin(q1+q2),0;0,0,0.1E1];\\n\"\>"], "Output",
 CellChangeTimes->{3.6968383260901375`*^9}],

Cell[BoxData["\<\"[0,0,0;0,0,0;1.E0,1.E0,0];\\n\"\>"], "Output",
 CellChangeTimes->{3.6968383261111383`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"replacerule", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["q", "1"], "[", "t", "]"}], "\[Rule]", "q1"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        SubscriptBox["q", "1"], "\[Prime]",
        MultilineFunction->None], " ", "[", "t", "]"}], "\[Rule]", "qD1"}], 
     ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "2"], "[", "t", "]"}], "\[Rule]", "q2"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        SubscriptBox["q", "2"], "\[Prime]",
        MultilineFunction->None], " ", "[", "t", "]"}], "\[Rule]", "qD2"}], 
     ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "3"], "[", "t", "]"}], "\[Rule]", "q3"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        SubscriptBox["q", "3"], "\[Prime]",
        MultilineFunction->None], " ", "[", "t", "]"}], "\[Rule]", "qD3"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "[", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      SubscriptBox["Jv", "TCP"], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "1"}], "}"}]}], "]"}], "]"}], "/.", "replacerule"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "[", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      SubscriptBox["J\[Omega]", "TCP"], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "1"}], "}"}]}], "]"}], "]"}], "/.", "replacerule"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6959717783056808`*^9, 3.695971805007208*^9}}],

Cell[BoxData["\<\"[(-0.25E0).*qD1.*cos(q1)+(-0.52066E0).*(qD1+qD2).*cos(q1+q2)\
+( ...\\n  -0.114715E0).*(qD1+qD2).*sin(q1+q2),(qD1+qD2).*((-0.52066E0).*cos( \
...\\n  q1+q2)+(-0.114715E0).*sin(q1+q2)),0;0.114715E0.*(qD1+qD2).*cos(q1+ \
...\\n  q2)+(-0.25E0).*qD1.*sin(q1)+(-0.52066E0).*(qD1+qD2).*sin(q1+q2),( ...\
\\n  qD1+qD2).*(0.114715E0.*cos(q1+q2)+(-0.52066E0).*sin(q1+q2)),0;0,0, \
...\\n  0];\\n\"\>"], "Output",
 CellChangeTimes->{3.696838326591166*^9}],

Cell[BoxData["\<\"[0,0,0;0,0,0;0,0,0];\\n\"\>"], "Output",
 CellChangeTimes->{3.6968383265941663`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"replacerule", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["q", "1"], "[", "t", "]"}], "\[Rule]", "q1"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        SubscriptBox["q", "1"], "\[Prime]",
        MultilineFunction->None], " ", "[", "t", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "2"], "[", "t", "]"}], "\[Rule]", "q2"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        SubscriptBox["q", "2"], "\[Prime]",
        MultilineFunction->None], " ", "[", "t", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "3"], "[", "t", "]"}], "\[Rule]", "q3"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        SubscriptBox["q", "3"], "\[Prime]",
        MultilineFunction->None], " ", "[", "t", "]"}], "\[Rule]", "0"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "[", 
  RowBox[{
   RowBox[{"Chop", "@", "h"}], "/.", "replacerule"}], "]"}]}], "Input",
 CellChangeTimes->{
  3.680811185415408*^9, {3.680811238171426*^9, 3.6808112421936555`*^9}}],

Cell[BoxData["\<\"[0;0;0.123985E2];\\n\"\>"], "Output",
 CellChangeTimes->{3.6968383266151676`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"replacerule", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["q", "1"], "[", "t", "]"}], "\[Rule]", "q1"}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "2"], "[", "t", "]"}], "\[Rule]", "q2"}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "3"], "[", "t", "]"}], "\[Rule]", "q3"}], ",", 
     RowBox[{
      SubscriptBox["F", "x"], "\[Rule]", "Fx"}], ",", 
     RowBox[{
      SubscriptBox["F", "y"], "\[Rule]", "Fy"}], ",", 
     RowBox[{
      SubscriptBox["F", "z"], "\[Rule]", "Fz"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "[", 
  RowBox[{
   RowBox[{"Chop", "@", "FORCE"}], "/.", "replacerule"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "[", 
  RowBox[{
   RowBox[{"Chop", "@", 
    RowBox[{"Simplify", "@", "f"}]}], "/.", "replacerule"}], "]"}]}], "Input",
 CellChangeTimes->{{3.675621495415533*^9, 3.67562151127344*^9}, {
   3.675621583841591*^9, 3.6756216215547476`*^9}, {3.6756593294442205`*^9, 
   3.675659336800641*^9}, 3.6765671236963644`*^9}],

Cell[BoxData["\<\"[Fx.*(0.114715E0.*cos(q1+q2)+(-0.25E0).*sin(q1)+(-0.52066E0)\
.*sin( ...\\n  \
q1+q2))+Fy.*(0.25E0.*cos(q1)+0.52066E0.*cos(q1+q2)+0.114715E0.* ...\\n  \
sin(q1+q2));Fx.*(0.114715E0.*cos(q1+q2)+(-0.52066E0).*sin(q1+q2))+ ...\\n  \
Fy.*(0.52066E0.*cos(q1+q2)+0.114715E0.*sin(q1+q2));0.1E1.*Fz];\\n\"\>"], \
"Output",
 CellChangeTimes->{3.696838326637169*^9}],

Cell[BoxData["\<\"[Fx;Fy;Fz;0;0;0];\\n\"\>"], "Output",
 CellChangeTimes->{3.6968383266901717`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"replacerule", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["q", "1"], "[", "t", "]"}], "\[Rule]", "q1"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        SubscriptBox["q", "1"], "\[Prime]",
        MultilineFunction->None], " ", "[", "t", "]"}], "\[Rule]", "q1d"}], 
     ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "2"], "[", "t", "]"}], "\[Rule]", "q2"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        SubscriptBox["q", "2"], "\[Prime]",
        MultilineFunction->None], " ", "[", "t", "]"}], "\[Rule]", "q2d"}], 
     ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "3"], "[", "t", "]"}], "\[Rule]", "q3"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        SubscriptBox["q", "3"], "\[Prime]",
        MultilineFunction->None], " ", "[", "t", "]"}], "\[Rule]", "q3d"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox["A", "full"], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "]"}], "]"}], "/.", 
   "replacerule"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "[", 
  RowBox[{
   RowBox[{"gg", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "3", ",", "2"}], "}"}], ",", "All"}], "]"}], "]"}], "/.",
    "replacerule"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "[", 
  RowBox[{
   RowBox[{"Normal", "@", 
    RowBox[{"B", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "3", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "]"}], "]"}]}], "/.", 
   "replacerule"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "[", 
  RowBox[{
   RowBox[{"M", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "3", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "]"}], "]"}], "/.", 
   "replacerule"}], "]"}]}], "Input",
 CellChangeTimes->{{3.695320732887683*^9, 3.6953207605412645`*^9}, {
   3.695358231710183*^9, 3.695358310356681*^9}, {3.695358355357255*^9, 
   3.695358357620384*^9}, 3.695358456400034*^9, {3.695359268102461*^9, 
   3.69535929081676*^9}, {3.6953593327241573`*^9, 3.695359337794447*^9}, {
   3.695359449004808*^9, 3.695359456810254*^9}, {3.6953602915820007`*^9, 
   3.6953602928830748`*^9}, {3.6953607068377523`*^9, 
   3.6953607142931786`*^9}, {3.6953608854779696`*^9, 3.6953608921743526`*^9}}],

Cell[BoxData["\<\"[0.114715E0.*cos(q1+q2)+(-0.25E0).*sin(q1)+(-0.52066E0).*\
sin(q1+ ...\\n  \
q2),0,0.114715E0.*cos(q1+q2)+(-0.52066E0).*sin(q1+q2)];\\n\"\>"], "Output",
 CellChangeTimes->{3.6968383267831774`*^9}],

Cell[BoxData["\<\"[0;0.123985E2;0];\\n\"\>"], "Output",
 CellChangeTimes->{3.696838326786177*^9}],

Cell[BoxData["\<\"[(-0.176909E-2).*q2d.*(0.1E1.*cos(q2)+0.172896E3.*sin(q2)),\
0,q1d.* ...\\n  ((-0.176909E-2).*cos(q2)+(-0.305869E0).*sin(q2))+q2d.*(( \
...\\n  -0.176909E-2).*cos(q2)+(-0.305869E0).*sin(q2));0,0,0;q1d.*( ...\\n  \
0.176909E-2.*cos(q2)+0.305869E0.*sin(q2)),0,0];\\n\"\>"], "Output",
 CellChangeTimes->{3.696838326800178*^9}],

Cell[BoxData["\<\"[0.992754E0+0.611737E0.*cos(q2)+(-0.353817E-2).*sin(q2),0, \
...\\n  0.375243E0+0.305869E0.*cos(q2)+(-0.176909E-2).*sin(q2);0, ...\\n  \
0.126386E1,0;0.375243E0+0.305869E0.*cos(q2)+(-0.176909E-2).*sin( ...\\n  \
q2),0,0.375243E0];\\n\"\>"], "Output",
 CellChangeTimes->{3.6968383268101788`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ToMatlab", "[", 
  RowBox[{"FF", "/.", "replacerule"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "[", 
  RowBox[{"EE", "/.", "replacerule"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Inverse", "[", "TT", "]"}], "/.", "replacerule"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "[", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["A", "full"], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "1"}], "}"}]}], "]"}], "]"}], "/.", "replacerule"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6953608976276646`*^9, 3.695360935344822*^9}, {
  3.6953611623278046`*^9, 3.695361208010417*^9}, {3.695361353823757*^9, 
  3.695361369748668*^9}}],

Cell[BoxData["\<\"[1,0;0,1;(0.1E1.*cos(q1+q2)+(-0.453872E1).*sin(q1+q2)).^(-1)\
.*(( ...\\n  -0.1E1).*cos(q1+q2)+0.217931E1.*sin(q1)+0.453872E1.*sin(q1+q2)), \
...\\n  0];\\n\"\>"], "Output",
 CellChangeTimes->{3.696838326869182*^9}],

Cell[BoxData["\<\"[0;0;(0.114715E0.*cos(q1+q2)+(-0.52066E0).*sin(q1+q2)).^(-1)\
];\\n\"\>"], "Output",
 CellChangeTimes->{3.6968383268741827`*^9}],

Cell[BoxData["\<\"[1,0,0;0,1,0;0.114715E0.*cos(q1+q2)+(-0.25E0).*sin(q1)+( \
...\\n  -0.52066E0).*sin(q1+q2),0,0.114715E0.*cos(q1+q2)+(-0.52066E0).* \
...\\n  sin(q1+q2)];\\n\"\>"], "Output",
 CellChangeTimes->{3.696838326954187*^9}],

Cell[BoxData["\<\"[(-0.25E0).*q1d.*cos(q1)+(-0.52066E0).*(q1d+q2d).*cos(q1+q2)\
+( ...\\n  -0.114715E0).*(q1d+q2d).*sin(q1+q2),0,(q1d+q2d).*((-0.52066E0).* \
...\\n  cos(q1+q2)+(-0.114715E0).*sin(q1+q2))];\\n\"\>"], "Output",
 CellChangeTimes->{3.696838326958187*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Homokoz\[OAcute]", "Section",
 CellChangeTimes->{{3.6808070741352563`*^9, 3.6808070760573664`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "@", "B"}]], "Input",
 CellChangeTimes->{{3.6953583192611904`*^9, 3.695358325741561*^9}, {
  3.695358368014979*^9, 3.695358395290539*^9}, {3.695358428786455*^9, 
  3.6953584378679743`*^9}, {3.695359467820884*^9, 3.6953595067431107`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "0.001769085068210425`"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"1.`", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{"172.89649756083276`", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["q", "2"], "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "0.001769085068210425`"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
          RowBox[{"0.3058686121807494`", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["q", "1"], "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "0.0017690850682104244`"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "-", 
          RowBox[{"0.30586861218074934`", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["q", "2"], "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], "0"},
     {
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"0.001769085068210425`", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{"0.3058686121807494`", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["q", "2"], "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["q", "1"], "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], "0", "0"},
     {"0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {3, 3}, 0, {
     1, {{0, 2, 3, 3}, {{1}, {2}, {
       1}}}, {(-0.001769085068210425) (
        1. Cos[Subscript[$CellContext`q, 2][$CellContext`t]] + 
        172.89649756083276` Sin[Subscript[$CellContext`q, 2][$CellContext`t]])
         Derivative[1][
        Subscript[$CellContext`q, 
          2]][$CellContext`t], ((-0.001769085068210425) 
          Cos[Subscript[$CellContext`q, 2][$CellContext`t]] - 
         0.3058686121807494 Sin[Subscript[$CellContext`q, 2][$CellContext`t]])
          Derivative[1][
         Subscript[$CellContext`q, 
           1]][$CellContext`t] + ((-0.0017690850682104244`) 
          Cos[Subscript[$CellContext`q, 2][$CellContext`t]] - 
         0.30586861218074934` 
         Sin[Subscript[$CellContext`q, 2][$CellContext`t]]) 
        Derivative[1][Subscript[$CellContext`q, 2]][$CellContext`t], (
        0.001769085068210425 
         Cos[Subscript[$CellContext`q, 2][$CellContext`t]] + 
        0.3058686121807494 Sin[Subscript[$CellContext`q, 2][$CellContext`t]]) 
       Derivative[1][
        Subscript[$CellContext`q, 1]][$CellContext`t]}}]]]]], "Output",
 CellChangeTimes->{3.6968383269901886`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", "x", "]"}], "^", "\[Gamma]"}], "*", 
      RowBox[{"Sign", "[", "x", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Gamma]", ",", "0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6953925093977504`*^9, 3.6953925344091806`*^9}, {
  3.695455730440014*^9, 3.695455792098541*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`\[Gamma]$$ = 0, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`\[Gamma]$$], 0, 1}}, Typeset`size$$ = {
    504., {152., 161.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`\[Gamma]$486528$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`\[Gamma]$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`\[Gamma]$$, $CellContext`\[Gamma]$486528$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Plot[Abs[$CellContext`x]^$CellContext`\[Gamma]$$ 
        Sign[$CellContext`x], {$CellContext`x, -1, 1}], 
      "Specifications" :> {{$CellContext`\[Gamma]$$, 0, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{569., {216., 223.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.696838327046192*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1350, 673},
WindowMargins->{{-2, Automatic}, {Automatic, 2}},
Magnification->1.5999999046325684`,
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (November 20, 2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 132, 1, 125, "Section"],
Cell[715, 25, 19155, 557, 2285, "Input"],
Cell[CellGroupData[{
Cell[19895, 586, 706, 16, 46, "Input"],
Cell[20604, 604, 1588, 45, 137, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[22241, 655, 133, 2, 125, "Section"],
Cell[22377, 659, 4741, 143, 366, "Input"],
Cell[CellGroupData[{
Cell[27143, 806, 3271, 94, 276, "Input"],
Cell[30417, 902, 946, 28, 96, "Output"],
Cell[31366, 932, 663, 19, 91, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32066, 956, 2608, 85, 314, "Input"],
Cell[34677, 1043, 2959, 87, 97, "Output"],
Cell[37639, 1132, 665, 19, 95, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38341, 1156, 2567, 85, 291, "Input"],
Cell[40911, 1243, 3083, 89, 155, "Output"],
Cell[43997, 1334, 695, 19, 151, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44729, 1358, 1606, 52, 183, "Input"],
Cell[46338, 1412, 3029, 87, 155, "Output"],
Cell[49370, 1501, 697, 19, 151, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[50116, 1526, 96, 1, 163, "Section"],
Cell[50215, 1529, 5936, 160, 543, "Input"],
Cell[56154, 1691, 5590, 156, 343, "Input"],
Cell[CellGroupData[{
Cell[61769, 1851, 1146, 36, 103, "Input"],
Cell[62918, 1889, 2232, 44, 1116, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65187, 1938, 1377, 45, 143, "Input"],
Cell[66567, 1985, 1103, 33, 188, "Output"],
Cell[67673, 2020, 2394, 71, 188, "Output"],
Cell[70070, 2093, 3295, 96, 188, "Output"]
}, Open  ]],
Cell[73380, 2192, 7987, 223, 945, "Input"],
Cell[CellGroupData[{
Cell[81392, 2419, 146, 3, 62, "Input"],
Cell[81541, 2424, 1723, 51, 155, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83301, 2480, 1405, 42, 103, "Input"],
Cell[84709, 2524, 2515, 52, 1795, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87261, 2581, 994, 24, 111, "Input"],
Cell[88258, 2607, 4707, 128, 491, "Output"],
Cell[92968, 2737, 799, 11, 463, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[93816, 2754, 109, 1, 163, "Section"],
Cell[CellGroupData[{
Cell[93950, 2759, 2285, 65, 204, "Input"],
Cell[96238, 2826, 1667, 49, 110, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97942, 2880, 794, 22, 118, "Input"],
Cell[98739, 2904, 217, 5, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[98993, 2914, 2301, 67, 268, "Input"],
Cell[101297, 2983, 5430, 141, 164, "Output"],
Cell[106730, 3126, 1807, 47, 155, "Output"],
Cell[108540, 3175, 2649, 74, 164, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111226, 3254, 322, 8, 62, "Input"],
Cell[111551, 3264, 3750, 100, 209, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[115338, 3369, 1094, 33, 103, "Input"],
Cell[116435, 3404, 652, 19, 151, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[117124, 3428, 2382, 65, 343, "Input"],
Cell[119509, 3495, 2204, 63, 155, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[121750, 3563, 585, 17, 103, "Input"],
Cell[122338, 3582, 2048, 59, 155, "Output"],
Cell[124389, 3643, 745, 25, 255, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125171, 3673, 807, 25, 62, "Input"],
Cell[125981, 3700, 2011, 40, 313, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[128041, 3746, 122, 1, 163, "Section"],
Cell[CellGroupData[{
Cell[128188, 3751, 5299, 134, 543, "Input"],
Cell[133490, 3887, 1809, 47, 155, "Output"],
Cell[135302, 3936, 4034, 106, 155, "Output"],
Cell[139339, 4044, 641, 19, 151, "Output"],
Cell[139983, 4065, 821, 25, 151, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140841, 4095, 1285, 28, 103, "Input"],
Cell[142129, 4125, 5705, 151, 164, "Output"],
Cell[147837, 4278, 5430, 141, 164, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[153304, 4424, 710, 18, 103, "Input"],
Cell[154017, 4444, 2951, 83, 155, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[157005, 4532, 2409, 68, 263, "Input"],
Cell[159417, 4602, 753, 24, 91, "Output"],
Cell[160173, 4628, 1800, 51, 91, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[162010, 4684, 2186, 58, 303, "Input"],
Cell[164199, 4744, 1889, 55, 180, "Output"],
Cell[166091, 4801, 1191, 35, 177, "Output"],
Cell[167285, 4838, 1844, 53, 153, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169166, 4896, 3117, 85, 303, "Input"],
Cell[172286, 4983, 12698, 334, 235, "Output"],
Cell[184987, 5319, 13869, 378, 212, "Output"],
Cell[198859, 5699, 639, 19, 151, "Output"],
Cell[199501, 5720, 2874, 83, 209, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[202412, 5808, 1422, 39, 143, "Input"],
Cell[203837, 5849, 2264, 46, 431, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[206150, 5901, 149, 2, 163, "Section"],
Cell[CellGroupData[{
Cell[206324, 5907, 1768, 53, 183, "Input"],
Cell[208095, 5962, 310, 4, 223, "Output"],
Cell[208408, 5968, 284, 4, 183, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[208729, 5977, 1981, 58, 223, "Input"],
Cell[210713, 6037, 251, 3, 183, "Output"],
Cell[210967, 6042, 354, 5, 223, "Output"],
Cell[211324, 6049, 108, 1, 103, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[211469, 6055, 1598, 50, 143, "Input"],
Cell[213070, 6107, 463, 6, 303, "Output"],
Cell[213536, 6115, 102, 1, 103, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[213675, 6121, 1163, 34, 103, "Input"],
Cell[214841, 6157, 99, 1, 103, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[214977, 6163, 1102, 31, 143, "Input"],
Cell[216082, 6196, 374, 6, 223, "Output"],
Cell[216459, 6204, 99, 1, 99, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[216595, 6210, 2638, 76, 223, "Input"],
Cell[219236, 6288, 214, 3, 135, "Output"],
Cell[219453, 6293, 97, 1, 99, "Output"],
Cell[219553, 6296, 341, 4, 209, "Output"],
Cell[219897, 6302, 312, 4, 209, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[220246, 6311, 981, 26, 183, "Input"],
Cell[221230, 6339, 233, 3, 172, "Output"],
Cell[221466, 6344, 146, 2, 99, "Output"],
Cell[221615, 6348, 233, 3, 172, "Output"],
Cell[221851, 6353, 267, 3, 172, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[222167, 6362, 105, 1, 161, "Section"],
Cell[CellGroupData[{
Cell[222297, 6367, 274, 4, 60, "Input"],
Cell[222574, 6373, 4034, 106, 147, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[226645, 6484, 544, 15, 60, "Input"],
Cell[227192, 6501, 1621, 33, 684, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
